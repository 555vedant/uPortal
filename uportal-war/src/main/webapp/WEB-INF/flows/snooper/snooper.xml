<?xml version="1.0" encoding="UTF-8"?>
<!--
    
    Copyright (c) 2000-2009, Jasig, Inc.
    See license distributed with this file and available online at
    https://www.ja-sig.org/svn/jasig-parent/tags/rel-10/license-header.txt
    
-->
<flow xmlns="http://www.springframework.org/schema/webflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/webflow
    http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">
    
    <!-- 
        Retrieve a list of the avaiable portal locales with display values 
        for the current locale
    -->
    <on-start>
        <set name="flowScope.currentLocale" 
            value="userLocaleHelper.getCurrentUserLocale(externalContext.getNativeRequest())"/>
        <set name="flowScope.locales" value="userLocaleHelper.getLocales(currentLocale)"/>
    </on-start>
    
    <!-- Sole view for this flow -->
    <view-state id="snooper">
        <on-render>
            <!-- Supply the JSP page with the HttpServletRequest object -->
            <set name="flashScope.request" value="portalRequestUtils.getOriginalPortalRequest(externalContext.getNativeRequest())"/>
        </on-render>
    </view-state>
    
</flow>