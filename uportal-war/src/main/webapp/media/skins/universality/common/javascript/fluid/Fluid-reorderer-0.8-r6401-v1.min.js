(function(e){var c="http://www.w3.org/2005/07/aaa";var f=["main","secondary","navigation","banner","contentinfo","statements","note","seealso","search"];var a=new RegExp("^"+f.join("|")+"$");var d=e.browser.mozilla&&(parseFloat(e.browser.version)<1.9);var b=(function(){if(d){return function(i,g,h){if(typeof h!="undefined"){i.each(function(j,k){k.setAttributeNS(c,"aaa:"+g,h)})}else{return i.get(0).getAttributeNS(c,g)}}}else{return function(i,g,h){if(typeof h!="undefined"){i.each(function(j,k){e(k).attr("aria-"+g,h)})}else{return i.attr("aria-"+g)}}}})();e.fn.extend({ariaRole:function(h){var g=this;if(h){h=(a.test(h)||!d)?h:"wairole:"+h;g.each(function(j,k){e(k).attr("role",h)});return g}else{var h=g.eq(0).attr("role");if(h){h=h.replace(/^wairole:/,"")}return h}},ariaState:function(){var g=arguments;var h=this;if(g.length==2){h.each(function(j,k){b(e(k),g[0],g[1])});return h}else{if(typeof g[0]=="string"){return b(h.eq(0),g[0])}else{h.each(function(j,k){e.each(g[0],function(i,l){e(k).ariaState(i,l)})});return h}}}});e.extend(e.expr[":"],{ariaRole:"jQuery(a).ariaRole()==m[3]",ariaState:"jQuery(a).ariaState(m[3].split(/=/)[0])==(/=/.test(m[3])?m[3].split(/=/)[1]:'true')"})})(jQuery);var fluid_0_8=fluid_0_8||{};var fluid=fluid||fluid_0_8;(function(t,p){p.thatistBridge=function(M,O){var N=function(P){var R=P.split(".");var Q=O;for(var U=0;U<R.length;++U){Q=Q[R[U]]}var T=[this];if(arguments.length===2){T=T.concat(t.makeArray(arguments[1]))}var S=Q.apply(null,T);this.that=function(){return S};var V=typeof(S);return !S||V==="string"||V==="number"||V==="boolean"||S&&S.length!==undefined?S:this};t.fn[M]=N;return N};p.thatistBridge("fluid",p);p.thatistBridge("fluid_0_8",fluid_0_8);var K="fluid-keyboard-a11y";var k=function(O,M){var N=t(O).data(K);return N?N[M]:undefined};var m=function(O,M,N){t(O).each(function(){var P=t.data(this,K)||{};P[M]=N;t.data(this,K,P)})};var J=function(){return t.browser.msie?"tabIndex":"tabindex"};var v=function(M){if(M.length<=0){return false}return t(M[0]).is("a, input, button, select, area, textarea, object")};var y=function(N){if(N.length<=0){return undefined}if(!p.tabindex.hasAttr(N)){return v(N)?Number(0):undefined}var M=N.attr(J());return Number(M)};var w=function(M,N){return M.each(function(O,P){t(P).attr(J(),N)})};p.tabindex=function(N,M){N=t(N);if(M!==null&&M!==undefined){return w(N,M)}else{return y(N)}};p.tabindex.remove=function(M){M=t(M);return M.each(function(N,O){t(O).removeAttr(J())})};p.tabindex.hasAttr=function(N){N=t(N);if(N.length<=0){return false}var M=N.map(function(){var O=this.getAttributeNode(J());return O?O.specified:false});return M.length===1?M[0]:M};p.tabindex.has=function(M){M=t(M);return p.tabindex.hasAttr(M)||v(M)};var h="enablement";p.enabled=function(N,M){N=t(N);if(M===undefined){return k(N,h)!==false}else{t("*",N).each(function(){if(k(this,h)!==undefined){m(this,h,M)}else{if(/select|textarea|input/i.test(this.nodeName)){t(this).attr("disabled",!M)}}});m(N,h,M)}};p.a11y=t.a11y||{};p.a11y.keys={UP:38,DOWN:40,LEFT:37,RIGHT:39,SPACE:32,ENTER:13,DELETE:46,TAB:9,CTRL:17,SHIFT:16,ALT:18};p.a11y.orientation={HORIZONTAL:0,VERTICAL:1,BOTH:2};var e={next:p.a11y.keys.DOWN,previous:p.a11y.keys.UP};var q={next:p.a11y.keys.RIGHT,previous:p.a11y.keys.LEFT};var c=function(M){return M.jquery?M[0]:M};var n=function(M){M.each(function(N,O){O=t(O);if(!O.fluid("tabindex.has")||O.fluid("tabindex")<0){O.fluid("tabindex",0)}})};p.tabbable=function(M){M=t(M);n(M)};var E="selectionContext";var C=-32768;var l=function(M){if(M.onLeaveContainer){M.onLeaveContainer(M.selectables[M.activeItemIndex])}else{if(M.onUnselect){M.onUnselect(M.selectables[M.activeItemIndex])}}if(!M.options.rememberSelectionState){M.activeItemIndex=C}};var g=function(M,N){if(N){N(M)}};var x=function(N,M){if(M&&N){M(N)}};var j=function(N,M){x(N,M.options.onUnselect)};var s=function(M,N){j(N.selectedElement(),N);M=c(M);var O=N.selectables.index(M);if(O===-1){return}N.activeItemIndex=O;g(M,N.options.onSelect)};var G=function(M){return function(N){s(N.target,M);return N.stopPropagation()}};var r=function(M){return function(N){j(N.target,M);return N.stopPropagation()}};var L=function(M){var N=M.selectables;if(M.activeItemIndex>=N.length){M.activeItemIndex=0}if(M.activeItemIndex<0&&M.activeItemIndex!==C){M.activeItemIndex=N.length-1}if(M.activeItemIndex>=0){t(N[M.activeItemIndex]).focus()}};var d=function(M){j(M.selectedElement(),M);if(M.activeItemIndex===C){M.activeItemIndex=-1}};var o=function(M){d(M);++M.activeItemIndex;L(M)};var f=function(M){d(M);--M.activeItemIndex;L(M)};var A=function(M,O,N){return function(P){if(P.which===O.next){o(M);P.preventDefault()}else{if(P.which===O.previous){f(M);P.preventDefault()}}}};var F=function(M){var N;if(M===p.a11y.orientation.HORIZONTAL){N=q}else{if(M===p.a11y.orientation.VERTICAL){N=e}}return N};var I=function(M){return function(N){if(N.which!==p.a11y.keys.TAB){return}l(M);if(N.shiftKey){M.focusIsLeavingContainer=true}}};var z=function(M){return function(N){var P=M.options.autoSelectFirstItem;var O=typeof(P)==="function"?P():P;if(M.focusIsLeavingContainer){O=false}if(O&&N.target===M.container.get(0)){if(M.activeItemIndex===C){M.activeItemIndex=0}t(M.selectables[M.activeItemIndex]).focus()}return N.stopPropagation()}};var b=function(M){return function(N){M.focusIsLeavingContainer=false;return N.stopPropagation()}};var B=function(N,Q,R){var O=t.extend(true,{},Q,R);var S=F(O.direction);var M=O.selectableElements?O.selectableElements:N.find(O.selectableSelector);var P={container:N,activeItemIndex:C,selectables:M,focusIsLeavingContainer:false,options:O};P.selectablesUpdated=function(T){if(typeof(P.options.selectablesTabindex)==="number"){P.selectables.fluid("tabindex",P.options.selectablesTabindex)}P.selectables.unbind("focus."+K);P.selectables.unbind("blur."+K);P.selectables.bind("focus."+K,G(P));P.selectables.bind("blur."+K,r(P));if(T){s(T,P)}else{L(P)}};P.refresh=function(){if(!P.options.selectableSelector){throw ("Cannot refresh selectable context which was not initialised by a selector")}P.selectables=N.find(O.selectableSelector);P.selectablesUpdated()};P.selectedElement=function(){return P.activeItemIndex<0?null:P.selectables[P.activeItemIndex]};if(S){N.keydown(A(P,S))}N.keydown(I(P));N.focus(z(P));N.blur(b(P));P.selectablesUpdated();return P};p.selectable=function(O,M){O=t(O);var N=B(O,p.selectable.defaults,M);m(O,E,N);return N};p.selectable.select=function(N,M){t(M).focus()};p.selectable.selectNext=function(M){M=t(M);o(k(M,E))};p.selectable.selectPrevious=function(M){M=t(M);f(k(M,E))};p.selectable.currentSelection=function(N){N=t(N);var M=k(N,E);return t(M.selectedElement())};p.selectable.defaults={direction:p.a11y.orientation.VERTICAL,selectablesTabindex:-1,autoSelectFirstItem:true,rememberSelectionState:true,selectableSelector:".selectable",selectableElements:null,onSelect:null,onUnselect:null,onLeaveContainer:null};var i=function(R,N){if(!R.modifier){return true}var O=R.modifier;var P=O&&N.ctrlKey;var M=O&&N.altKey;var Q=O&&N.shiftKey;return P||M||Q};var H=function(M){return function(N){var P=N.target;if(!p.enabled(N.target)){return}var O=N.which?N.which:N.keyCode;if(O===M.key&&M.activateHandler&&i(M,N)){M.activateHandler(N.target,N);N.preventDefault()}}};var u=function(N,M){return function(O){if(!M){return}O=c(O);if(N.index(O)===-1){return}M(O)}};var i=function(R,N){if(!R.modifier){return true}var O=R.modifier;var P=O&&N.ctrlKey;var M=O&&N.altKey;var Q=O&&N.shiftKey;return P||M||Q};var D=function(P,S,M,N){var R=[];t(M).each(function(T,U){R.push({modifier:null,key:U,activateHandler:S})});if(N&&N.additionalBindings){R=R.concat(N.additionalBindings)}m(P,h,true);for(var O=0;O<R.length;++O){var Q=R[O];P.keydown(H(Q))}};var a="defaultActivate";p.activatable=function(O,N,M){O=t(O);D(O,N,p.activatable.defaults.keys,M);m(O,a,u(O,N))};p.activate=function(N){N=t(N);var M=k(N,a);M(N)};p.activatable.defaults={keys:[p.a11y.keys.ENTER,p.a11y.keys.SPACE]}})(jQuery,fluid_0_8);if(!this.JSON){JSON=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(typeof value.toJSON==="function"){return stringify(value.toJSON())}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||"null")}return"["+a.join(",")+"]"}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}else{for(k in value){if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==="object"){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n}}}}return filter(k,v)}if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(:?[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof filter==="function"?walk("",j):j}throw new SyntaxError("parseJSON")}}}()}var fluid_0_8=fluid_0_8||{};var fluid=fluid||fluid_0_8;(function(f,e){e.version="Infusion 0.8";e.fail=function(h){e.setLogging(true);e.log(h.message?h.message:h);h.fail()};e.wrap=function(h){return((!h||h.jquery)?h:f(h))};e.unwrap=function(h){return h&&h.jquery&&h.length===1?h[0]:h};e.findKeyInObject=function(j,i){for(var h in j){if(j[h]===i){return h}}return null};e.clear=function(j){if(j instanceof Array){j.length=0}else{for(var h in j){delete j[h]}}};e.container=function(i){var h=i;if(typeof i==="string"||i.nodeType&&(i.nodeType===1||i.nodeType===9)){h=f(i)}if(!h||!h.jquery||h.length!==1){if(typeof(i)!=="string"){i=h.selector}e.fail({name:"NotOne",message:"A single container element was not found for selector "+i})}return h};var c={};var b={};e.defaults=function(){var k=0;var i=c;if(typeof arguments[0]==="boolean"){i=b;k=1}var h=arguments[k];var j=arguments[k+1];if(j!==undefined){i[h]=j;return j}return i[h]};e.createDomBinder=function(i,k){var j={},l={};function m(o,n){return f.data(e.unwrap(n))+"-"+o}function h(p,o,n){j[m(p,o)]=n}l.locate=function(p,r){var n,o,q;n=k[p];o=r?r:i;if(!o){e.fail("DOM binder invoked for selector "+p+" without container")}if(!n){return o}if(typeof(n)==="function"){q=f(n.call(null,e.unwrap(o)))}else{q=f(n,o)}if(q.get(0)===document){q=[]}if(!q.selector){q.selector=n;q.context=o}q.selectorName=p;h(p,o,q);return q};l.fastLocate=function(o,r){var n=r?r:i;var p=m(o,n);var q=j[p];return q?q:l.locate(o,r)};l.clear=function(){j={}};l.refresh=function(q,r){var o=r?r:i;if(typeof q==="string"){q=[q]}if(o.length===undefined){o=[o]}for(var p=0;p<q.length;++p){for(var n=0;n<o.length;++n){l.locate(q[p],o[n])}}};return l};e.mergeListeners=function(k,n){if(n){for(var j in n){var o=n[j];var p=j.indexOf(".");var m;if(p!==-1){m=j.substring(p+1);j=j.substring(0,p)}if(!k[j]){k[j]=e.event.getEventFirer()}var l=k[j];if(typeof(o)==="function"){l.addListener(o,m)}else{if(o&&typeof o.length==="number"){for(var h=0;h<o.length;++h){l.addListener(o[h],m)}}}}}};e.instantiateFirers=function(k,h){k.events={};if(h.events){for(var j in h.events){var i=h.events[j];k.events[j]=e.event.getEventFirer(i==="unicast",i==="preventable")}}e.mergeListeners(k.events,h.listeners)};e.mergeComponentOptions=function(i,h,k){var j=e.defaults(h);i.options=e.merge(j?j.mergePolicy:null,{},j,k)};e.initView=function(i,h,l){var k={};if(h&&h.length===0&&h.jquery){var j='Error instantiating component with name "'+i+'": selector "'+h.selector+'" with name '+h.selectorName+" returned no results in context "+e.dumpEl(h.context);e.fail(j)}e.mergeComponentOptions(k,i,l);if(h){k.container=e.container(h);e.initDomBinder(k)}e.instantiateFirers(k,k.options);return k};e.COMPONENT_OPTIONS={};e.emptySubcomponent=function(h){var k={};h=f.makeArray(h);for(var j=0;j<h.length;++j){k[h[j]]=function(){}}return k};e.initSubcomponent=function(j,i,h){return e.initSubcomponents(j,i,h)[0]};e.initSubcomponents=function(o,p,q){var r=o.options[p];if(!r){return}var n=f.makeArray(r);var s=-1;var k=[];q=f.makeArray(q);for(var m=0;m<q.length;++m){if(q[m]===e.COMPONENT_OPTIONS){s=m}}for(m=0;m<n.length;++m){r=n[m];if(s!==-1&&r.options){q[s]=r.options}if(typeof(r)!=="function"){var l=typeof(r)==="string"?r:r.type;var h=e.defaults(true,l);e.merge("reverse",o.options,h);k[m]=l==="fluid.emptySubcomponent"?e.emptySubcomponent(r.options):e.invokeGlobalFunction(l,q,{fluid:e})}else{k[m]=r.apply(null,q)}var j=k[m].returnedOptions;if(j){e.merge(o.options.mergePolicy,o.options,j);if(j.listeners){e.mergeListeners(o.events,j.listeners)}}}return k};e.initDomBinder=function(h){h.dom=e.createDomBinder(h.container,h.options.selectors);h.locate=h.dom.locate};e.isPrimitive=function(h){var i=typeof(h);return !h||i==="string"||i==="boolean"||i==="number"};function g(m,o,l,h){var p=m&&typeof(m)!=="string"?m[o]:m;if(typeof(p)==="function"){p.apply(null,l,h);return l}if(p==="replace"){e.clear(l)}for(var j in h){var q=(o?o+".":"")+j;var n=l[j];var k=h[j];var i=e.isPrimitive(n);if(k!==undefined){if(k!==null&&typeof k==="object"&&!k.nodeType&&!k.jquery){if(i){l[j]=n=k instanceof Array?[]:{}}g(m,q,n,k)}else{if(n===null||n===undefined||p!=="reverse"){l[j]=k}}}}return l}e.merge=function(m,l){var q="";for(var k=2;k<arguments.length;++k){var h=arguments[k];if(h!==null&&h!==undefined){g(m,q,l,h)}}if(m&&typeof(m)!=="string"){for(var o in m){var p=m[o];if(typeof(p)==="string"&&p!=="replace"){var j=e.model.getBeanValue(l,o);if(j===null||j===undefined){var n=e.model.getBeanValue(l,p);e.model.setBeanValue(l,o,n)}}}}return l};e.copy=function(h){return f.extend(true,{},h)};e.invokeGlobalFunction=function(i,j,h){var k=e.model.getBeanValue(window,i,h);if(!k){e.fail("Error invoking global function: "+i+" could not be located")}else{return k.apply(null,j)}};e.event={};var a=1;e.event.getEventFirer=function(j,k){var i=e.log;var h={};return{addListener:function(m,l){if(!m){return}if(j){l="unicast"}if(!l){if(!m.$$guid){m.$$guid=a+=1}l=m.$$guid}h[l]={listener:m}},removeListener:function(l){if(typeof(l)==="string"){delete h[l]}else{if(typeof(l)==="object"&&l.$$guid){delete h[l.$$guid]}}},fire:function(){for(var n in h){var l=h[n];try{var m=l.listener.apply(null,arguments);if(k&&m===true){return true}}catch(o){i("FireEvent received exception "+o.message+" e "+o+" firing to listener "+n);throw (o)}}}}};e.model={};e.model.copyModel=function(i,h){e.clear(i);f.extend(true,i,h)};e.model.parseEL=function(h){return h.split(".")};e.model.setBeanValue=function(j,l,m){var h=e.model.parseEL(l);for(var k=0;k<h.length-1;k+=1){if(!j[h[k]]){j[h[k]]={}}j=j[h[k]]}j[h[h.length-1]]=m};e.model.getBeanValue=function(k,n,h){var j=e.model.parseEL(n);for(var l=0;l<j.length;l+=1){var m=j[l];if(h&&h[m]){k=h[m];h=null}else{k=k[j[l]]}if(!k){return k}}return k};var d;e.setLogging=function(h){if(typeof h=="boolean"){d=h}else{d=false}};e.log=function(h){if(d){h=new Date().toTimeString()+":  "+h;if(typeof(console)!=="undefined"){if(console.debug){console.debug(h)}else{console.log(h)}}else{if(typeof(YAHOO)!=="undefined"){YAHOO.log(h)}else{if(typeof(opera)!=="undefined"){opera.postError(h)}}}}};e.dumpEl=function(j){var k;if(!j){return"null"}if(j.nodeType===3||j.nodeType===8){return"[data: "+j.data+"]"}if(j.nodeType===9){return"[document: location "+j.location+"]"}if(typeof j.length==="number"){k="[";for(var h=0;h<j.length;++h){k+=e.dumpEl(j[h]);if(h<j.length-1){k+=", "}}return k+"]"}j=f(j);k=j.get(0).tagName;if(j.attr("id")){k+="#"+j.attr("id")}if(j.attr("class")){k+="."+j.attr("class")}return k};e.findAncestor=function(h,i){return i(h)?h:f.grep(f(h).parents(),i)[0]};e.jById=function(i){var h=e.byId(i);return h?f(h):null};e.byId=function(i){var h=document.getElementById(i);if(h){if(h.getAttribute("id")!==i){e.fail("Problem in document structure - picked up element "+e.dumpEl(h)+" for id "+i+" without this id - most likely the element has a name which conflicts with this id")}return h}else{return null}};e.getId=function(h){return e.unwrap(h).getAttribute("id")};e.allocateSimpleId=function(h){h=e.unwrap(h);if(!h.id){h.id="fluid-id-"+(a++)}return h.id};e.transform=function(n){var m=[];for(var l=0;l<n.length;++l){var h=n[l];for(var k=0;k<arguments.length-1;++k){h=arguments[k+1](h,l)}m[m.length]=h}return m};e.find=function(l,k,m){for(var j=0;j<l.length;++j){var h=k(l[j],j);if(h!==null&&h!==undefined){return h}}return m};e.accumulate=function(l,k,h){for(var j=0;j<l.length;++j){h=k(l[j],h,j)}return h};e.remove_if=function(k,j){for(var h=0;h<k.length;++h){if(j(k[h],h)){k.splice(h,1);--h}}return k};e.formatMessage=function(k,h){if(!h){return k}if(typeof(h)==="string"){h=[h]}for(var j=0;j<h.length;++j){k=k.replace("{"+j+"}",h[j])}return k};e.messageLocator=function(h){return function(j,k){if(typeof(j)==="string"){j=[j]}for(var l=0;l<j.length;++l){var n=j[l];var m=h[n];if(m===undefined){continue}return e.formatMessage(m,k)}return"[Message string for key "+j[0]+" not found]"}};e.stringTemplate=function(l,i){var k=l;for(var j in i){if(i.hasOwnProperty(j)){var h="%"+j;k=k.replace(h,i[j])}}return k}})(jQuery,fluid_0_8);var fluid_0_8=fluid_0_8||{};(function(c,b){b.dom=b.dom||{};var a=function(d){if(d.node.firstChild){d.node=d.node.firstChild;d.depth+=1;return d}while(d.node){if(d.node.nextSibling){d.node=d.node.nextSibling;return d}d.node=d.node.parentNode;d.depth-=1}return d};b.dom.iterateDom=function(h,g){var f={node:h,depth:0};var e=h;while(f.node!==null&&f.depth>=0&&f.depth<b.dom.iterateDom.DOM_BAIL_DEPTH){var d=false;if(f.node.nodeType===1){d=g(f.node,f.depth)}if(d){f.node.parentNode.removeChild(f.node);f.node=e}e=f.node;f=a(f)}};b.dom.iterateDom.DOM_BAIL_DEPTH=256;b.dom.computeAbsolutePosition=function(d){var f=0,e=0;if(d.offsetParent){do{f+=d.offsetLeft;e+=d.offsetTop;d=d.offsetParent}while(d);return[f,e]}};b.dom.isContainer=function(d,e){for(;e;e=e.parentNode){if(d===e){return true}}return false};b.dom.insertAfter=function(d,e){var f=e.nextSibling;if(!f){e.parentNode.appendChild(d)}else{e.parentNode.insertBefore(d,f)}};b.dom.isWhitespaceNode=function(d){return !(/[^\t\n\r ]/.test(d.data))};b.dom.isIgnorableNode=function(d){return(d.nodeType===8)||((d.nodeType===3)&&b.dom.isWhitespaceNode(d))};b.dom.getElementText=function(f){var d=f.childNodes;var g="";for(var e=0;e<d.length;++e){var h=d[e];if(h.nodeType==3){g=g+h.nodeValue}}return g};b.dom.cleanseScripts=function(d){var e=c.data(d,b.dom.cleanseScripts.MARKER);if(!e){b.dom.iterateDom(d,function(f){return(f.tagName.toLowerCase()==="script")});c.data(d,b.dom.cleanseScripts.MARKER,true)}};b.dom.cleanseScripts.MARKER="fluid-scripts-cleansed"})(jQuery,fluid_0_8);var fluid_0_8=fluid_0_8||{};(function(f,g){g.orientation={HORIZONTAL:4,VERTICAL:1};g.rectSides={4:["left","right"],1:["top","bottom"],8:"top",12:"bottom",2:"left",3:"right"};g.position={BEFORE:-1,AFTER:1,INSIDE:2,REPLACE:3};g.direction={NEXT:1,PREVIOUS:-1,UP:8,DOWN:12,LEFT:2,RIGHT:3};g.directionSign=function(k){return k===g.direction.UP||k===g.direction.LEFT?g.direction.PREVIOUS:g.direction.NEXT};g.directionAxis=function(k){return k===g.direction.LEFT||k===g.direction.RIGHT?0:1};g.directionOrientation=function(k){return g.directionAxis(k)?g.orientation.VERTICAL:g.orientation.HORIZONTAL};g.keycodeDirection={up:g.direction.UP,down:g.direction.DOWN,left:g.direction.LEFT,right:g.direction.RIGHT};g.moveDom=function(m,n,k){m=g.unwrap(m);n=g.unwrap(n);var l;if(k===g.position.INSIDE){n.appendChild(m)}else{if(k===g.position.BEFORE){for(l=n.previousSibling;;l=l.previousSibling){if(!l||!g.dom.isIgnorableNode(l)){if(l!==m){g.dom.cleanseScripts(m);n.parentNode.insertBefore(m,n)}break}}}else{if(k===g.position.AFTER){for(l=n.nextSibling;;l=l.nextSibling){if(!l||!g.dom.isIgnorableNode(l)){if(l!==m){g.dom.cleanseScripts(m);g.dom.insertAfter(m,n)}break}}}else{g.fail("Unrecognised position supplied to fluid.moveDom: "+k)}}}};g.normalisePosition=function(l,n,k,m){if(l===g.position.REPLACE){l=n&&k>=m?g.position.AFTER:g.position.BEFORE}return l};g.permuteDom=function(n,r,q,l,o){n=g.unwrap(n);r=g.unwrap(r);var p=f.inArray(n,l);if(p===-1){g.fail("Error in permuteDom: source element "+g.dumpEl(n)+" not found in source list "+g.dumpEl(l))}var v=f.inArray(r,o);if(v===-1){g.fail("Error in permuteDom: target element "+g.dumpEl(r)+" not found in source list "+g.dumpEl(o))}var k=l===o;q=g.normalisePosition(q,k,v,p);var u={};u[g.position.AFTER]=n.nextSibling;u[g.position.BEFORE]=n.previousSibling;g.moveDom(l[p],o[v],q);var t=k?v-1:l.length-2;var m;if(!k||v>p){for(m=t;m>p;--m){g.moveDom(l[m+1],l[m],g.position.AFTER)}if(p+1<l.length){g.moveDom(l[p+1],u[g.position.AFTER],g.position.BEFORE)}}var s=k?p-1:o.length-1;if(q===g.position.AFTER){v++}if(!k||v<p){for(m=v;m<s;++m){g.moveDom(o[m],o[m+1],g.position.BEFORE)}if(s>=0&&s<o.length-1){g.moveDom(o[s],u[g.position.BEFORE],g.position.AFTER)}}};var b=function(k,l){return window.getComputedStyle?window.getComputedStyle(k,null).getPropertyValue(l):k.currentStyle[l]};var h=function(k){while(k){if(k.tagName.toLowerCase()==="body"){return true}k=k.parentNode}return false};var j=function(k){return"hidden"==k.type||b(k,"display")==="none"||b(k,"visibility")==="hidden"||!h(k)};var e=function(m,l,q){var o={};o.element=m;o.orientation=l;if(q===g.position.INSIDE){o.position=q}if(j(m)){o.clazz="hidden"}var p=g.dom.computeAbsolutePosition(m)||[0,0];var n=m.offsetWidth;var k=m.offsetHeight;o.rect={left:p[0],top:p[1]};o.rect.right=p[0]+n;o.rect.bottom=p[1]+k;return o};var c=10000;function d(k){return"Rect top: "+k.top+" left: "+k.left+" bottom: "+k.bottom+" right: "+k.right}function i(k){if(!k||!k.rect){return"null"}else{return d(k.rect)+" position: "+k.position+" for "+g.dumpEl(k.element)}}g.dropManager=function(){var s=[];var l={};var r={};var n;function t(x){return f(x).data("")}function u(x,C,A,B,D,z){var y=f.extend(true,{},A);y.rect[C[B]]=y.rect[C[1-B]]+(B?1:-1);y.rect[C[1-B]]=(B?-1:1)*c;y.position=D===g.position.INSIDE?D:(B?g.position.BEFORE:g.position.AFTER);y.clazz=z;x[x.length]=y}function q(A,y,z,x,C,B){var F=f.extend(true,{},z);var D=f.extend(true,{},z);var E=(F.rect[y[0]]+F.rect[y[1]])/2;F.rect[y[1]]=E;F.position=g.position.BEFORE;D.rect[y[0]]=E;D.position=g.position.AFTER;F.clazz=C;D.clazz=B;A[A.length]=F;A[A.length]=D}function p(z,y,A,x,B){y+=A;if(y<0&&x==="locked"){return"locked"}if(y>=z.length||B===null){return null}else{var A=z[y];return B(A)==="locked"&&x==="locked"?"locked":null}}var o;var m,k;r.updateGeometry=function(G){o=G;s=[];l={};var x=G.elementMapper;for(var F=0;F<G.extents.length;++F){var B=G.extents[F];var y=B.orientation;var z=g.rectSides[y];function A(L,I,O,P,K){var J=e(L,y,P);J.owner=B;if(J.clazz!=="hidden"&&x){J.clazz=x(L)}l[f.data(L)]=J;var M=p(B.elements,K,g.position.BEFORE,J.clazz,x);var N=p(B.elements,K,g.position.AFTER,J.clazz,x);if(P===g.position.INSIDE){s[s.length]=J}else{q(s,z,J,P,M,N)}if(I&&G.sentinelize){u(s,z,J,1,P,M)}if(O&&G.sentinelize){u(s,z,J,0,P,N)}return J}var H=true;for(var C=0;C<B.elements.length;++C){var E=B.elements[C];var D=A(E,C===0,C===B.elements.length-1,g.position.INTERLEAVED,C);if(D.clazz!=="hidden"){H=false}}if(H&&B.parentElement){A(B.parentElement,true,true,g.position.INSIDE)}}};r.startDrag=function(C,B,z,A){var E=B[0]+z/2;var D=B[1]+A/2;var y=E-C.pageX;var x=D-C.pageY;r.updateGeometry(o);n=null;m=y;k=x;f("").bind("mousemove.fluid-dropManager",r.mouseMove)};r.lastPosition=function(){return n};r.endDrag=function(){f("").unbind("mousemove.fluid-dropManager")};r.mouseMove=function(A){var z=A.pageX+m;var C=A.pageY+k;var B=r.closestTarget(z,C,n);if(B&&B!==g.dropManager.NO_CHANGE){n=B;r.dropChangeFirer.fire(B)}};r.dropChangeFirer=g.event.getEventFirer();var v={element:null};r.closestTarget=function(I,G,D){var C=Number.MAX_VALUE;var A=v;var z=Number.MAX_VALUE;var H=v;for(var F=0;F<s.length;++F){var E=s[F];if(E.clazz==="hidden"){continue}var B=g.geom.minPointRectangle(I,G,E.rect);if(E.clazz==="locked"){if(B<z){z=B;H=E}}else{if(B<C){C=B;A=E}if(B===0){break}}}if(!A){return A}if(z>=C){H=v}if(D&&D.position===A.position&&g.unwrap(D.element)===g.unwrap(A.element)&&g.unwrap(D.lockedelem)===g.unwrap(H.element)){return g.dropManager.NO_CHANGE}return{position:A.position,element:A.element,lockedelem:H.element}};r.projectFrom=function(A,C,B){r.updateGeometry(o);var z=l[t(A)];var y=g.geom.projectFrom(z.rect,C,s,B);if(!y.cacheelem){return null}var x=y.cacheelem.position;return{element:y.cacheelem.element,position:x?x:g.position.BEFORE}};function w(y,A,z){var B=g.directionSign(A);var x=f(z).index(y)+B;if(x<0){x+=z.length}x%=z.length;return z[x]}r.logicalFrom=function(y,A,z){var x=r.getOwningSpan(y,g.position.INTERLEAVED,z);return{element:w(y,A,x),position:g.position.REPLACE}};r.lockedWrapFrom=function(z,D,C){var B=r.logicalFrom(z,D,C);var x=r.getOwningSpan(z,g.position.INTERLEAVED,C);var A=l[t(z)].owner.elements;if(C||x[0]===A[0]){return B}var y=w(z,D,A);if(o.elementMapper(y)==="locked"){B.element=null;B.clazz="locked"}return B};r.getOwningSpan=function(z,y,B){var x=l[t(z)].owner;var A=y===g.position.INSIDE?[x.parentElement]:x.elements;if(!B&&o.elementMapper){A=f.makeArray(A);g.remove_if(A,function(C){return o.elementMapper(C)==="locked"})}return A};r.geometricMove=function(A,B,x){var y=r.getOwningSpan(A,null,true);var z=r.getOwningSpan(B,x,true);g.permuteDom(A,B,x,y,z)};return r};g.dropManager.NO_CHANGE="no change";g.geom=g.geom||{};g.geom.minPointRectangle=function(k,o,n){var m=k<n.left?(n.left-k):(k>n.right?(k-n.right):0);var l=o<n.top?(n.top-o):(o>n.bottom?(o-n.bottom):0);return m*m+l*l};g.geom.minRectRect=function(n,l){var m=n.right<l.left?l.left-n.right:l.right<n.left?n.left-l.right:0;var k=n.bottom<l.top?l.top-n.bottom:l.bottom<n.top?n.top-l.bottom:0;return m*m+k*k};var a=function(){return{mindist:Number.MAX_VALUE,minrdist:Number.MAX_VALUE}};g.geom.projectFrom=function(o,A,B,u){var m=g.directionAxis(A);var x=g.rectSides[A];var v=g.rectSides[m*15+5-A];var r=g.directionSign(A);var k={left:(7*o.left+1*o.right)/8,right:(5*o.left+3*o.right)/8,top:(7*o.top+1*o.bottom)/8,bottom:(5*o.top+3*o.bottom)/8};k[x]=r*c;k[v]=-k[x];function C(G,E,H){var F=E.rect;var I=g.geom.minRectRect(k,F);var D=-r*H*(o[H===1?x:v]-F[H===1?v:x]);if(I<=G.mindist&&D>=0){if(I==G.mindist&&D*H>G.minrdist){return}G.minrdist=D*H;G.mindist=I;G.minelem=E}}var s=a();var w=a();var n=a();for(var y=0;y<B.length;++y){var z=B[y];var l=z.owner&&z.element===z.owner.parentElement;if(z.clazz==="hidden"||u&&l){continue}else{if(!u&&z.clazz==="locked"){C(n,z,1)}else{C(s,z,1);C(w,z,-1)}}}var q=!s.minelem||w.mindist<s.mindist;var t=q?w:s;var p={wrapped:q,cacheelem:t.minelem};if(n.mindist<t.mindist){p.lockedelem=n.minelem}return p}})(jQuery,fluid_0_8);fluid_0_8=fluid_0_8||{};(function(c,d){var b=function(o,l,m){var n=c(o).clone();d.dom.iterateDom(n.get(0),function(p){if(p.tagName.toLowerCase()==="script"){return true}p.removeAttribute("id");if(p.tagName.toLowerCase()==="input"){p.setAttribute("disabled","disabled")}});n.removeAttr("id");n.removeClass("ui-droppable");n.addClass(l);if(m){var k=c(document.createElement("div"));k.append(n);k.append(m);n=k}c("body").append(n);if(!c.browser.safari){n.css("display","block").width(o.offsetWidth).height(o.offsetHeight)}if(c.browser.opera){n.hide()}return n};function f(l){var k=l.dom.fastLocate("selectables");if(k.length<=0){return null}return k[0]}function g(l,n,o,k){var m=n;var p=false;if(c.browser.msie){l[0].ondrag=function(){return false};l[0].onselectstart=function(){return false}}if(c.browser.opera){l.keypress(function(q){if(p){p=false;q.preventDefault();return false}});m=function(r){var q=n(r);if(q===false){p=true}}}l.keydown(m);l.keyup(o)}function j(k){var l=k.dom.fastLocate("selectables")[0];if(l){k.container.ariaState("activedescendent",l.id)}k.container.ariaRole(k.options.containerRole.container);k.container.ariaState("multiselectable","false");k.container.ariaState("readonly","false");k.container.ariaState("disabled","false")}function a(k){return k+"_avatar"}var i=function(k){if(k.keysets&&!(k.keysets instanceof Array)){k.keysets=[k.keysets]}};d.reorderer=function(z,m){if(!z){d.fail("Reorderer initialised with no container")}var A=d.initView("fluid.reorderer",z,m);m=A.options;var t=d.dropManager();A.layoutHandler=d.initSubcomponent(A,"layoutHandler",[z,m,t,A.dom]);A.activeItem=undefined;i(m);var k=A.locate("dropWarning");var x;if(k){x=k.clone()}var C=function(F){var H=m.keysets;for(var G=0;G<H.length;G++){if(H[G].modifier(F)){return true}}return false};var l=function(){return c.inArray(A.activeItem,A.dom.fastLocate("movables"))>=0};var n=function(F){A.dom.fastLocate("dropTargets").ariaState("dropeffect",F)};var u=m.styles;var v=function(F){return(!F.ctrlKey&&!F.altKey&&!F.shiftKey&&!F.metaKey)};var D=function(M){var O=A.activeItem;if(!O){return true}var F=m.keysets;for(var I=0;I<F.length;I++){var H=F[I];var P=false;var L=d.findKeyInObject(H,M.keyCode);if(!L){continue}var N=H.modifier(M);var G=d.keycodeDirection[L];var J=A.layoutHandler.getRelativePosition(O,G,!N);if(!J){continue}if(N){var K=A.events.onBeginMove.fire(O);if(K){return false}if(k.length>0){if(J.clazz==="locked"){A.events.onShowKeyboardDropWarning.fire(O,k);k.show()}else{k.hide()}}if(J.element){A.requestMovement(J,O)}}else{if(v(M)){c(J.element).focus()}}return false}return true};A.handleKeyDown=function(F){if(!A.activeItem||A.activeItem!==F.target){return true}var G=c(A.activeItem);if(!G.hasClass(u.dragging)&&C(F)){if(l()){G.removeClass(u.selected);G.addClass(u.dragging);G.ariaState("grab","true");n("move")}return false}return D(F)};A.handleKeyUp=function(F){if(!A.activeItem||A.activeItem!==F.target){return true}var G=c(A.activeItem);if(G.hasClass(u.dragging)&&!C(F)){if(k){k.hide()}G.removeClass(u.dragging);G.addClass(u.selected);G.ariaState("grab","supported");n("none");return false}return false};var o;var p=function(G){var F=c(document.createElement(G));F.addClass(m.styles.dropMarker);F.hide();return F};d.logEnabled=true;A.requestMovement=function(G,F){if(!G||d.unwrap(G.element)===d.unwrap(F)){return}A.events.onMove.fire(F,G);t.geometricMove(F,G.element,G.position);c(A.activeItem).focus();A.refresh();t.updateGeometry(A.layoutHandler.getGeometricInfo());A.events.afterMove.fire(F,G,A.dom.fastLocate("movables"))};var y=function(F,G){A.dom.fastLocate("grabHandle",F)[G?"addClass":"removeClass"](u.hover)};function s(H){var G=m.styles;H.ariaState("grab","supported");H.mouseover(function(){A.events.onHover.fire(H,true)});H.mouseout(function(){A.events.onHover.fire(H,false)});var F;A.dom.fastLocate("grabHandle",H).draggable({refreshPositions:false,scroll:true,helper:function(){var I;if(x){I=x[0]}F=c(m.avatarCreator(H[0],G.avatar,I));F.attr("id",a(A.container.id));return F},start:function(O,N){var J=A.events.onBeginMove.fire(H);if(J){return false}var M=A.dom.fastLocate("grabHandle",H)[0];var L=d.dom.computeAbsolutePosition(M);var I=M.offsetWidth;var K=M.offsetHeight;H.focus();H.removeClass(m.styles.selected);H.addClass(m.styles.mouseDrag);H.ariaState("grab","true");n("move");t.startDrag(O,L,I,K);F.show()},stop:function(K,J){H.removeClass(m.styles.mouseDrag);H.addClass(m.styles.selected);c(A.activeItem).ariaState("grab","supported");var I=d.unwrap(o);if(I.parentNode){I.parentNode.removeChild(I)}F.hide();J.helper=null;n("none");t.endDrag();A.requestMovement(t.lastPosition(),H);A.activeItem.focus()},handle:A.dom.fastLocate("grabHandle",H)})}function E(F,G){F.removeClass(G.selected);F.removeClass(G.dragging);F.addClass(G.defaultStyle);F.ariaState("selected","false")}var r=function(H){A.events.onSelect.fire(H);var G=m.styles;if(A.activeItem&&A.activeItem!==H){E(c(A.activeItem),G)}A.activeItem=H;var F=c(H);F.removeClass(G.defaultStyle);F.addClass(G.selected);F.ariaState("selected","true");A.container.ariaState("activedescendent",H.id)};var B=function(){var I=function(K){E(c(this),m.styles);return K.stopPropagation()};var J=function(K){r(this);return K.stopPropagation()};var F=A.dom.fastLocate("selectables");for(var H=0;H<F.length;++H){var G=c(F[H]);if(!c.data(G[0],"fluid.reorderer.selectable-initialised")){G.addClass(u.defaultStyle);F.blur(I);F.focus(J);F.click(function(K){var L=d.unwrap(A.dom.fastLocate("grabHandle",this));if(d.dom.isContainer(L,K.target)){c(this).focus()}});F.ariaRole(m.containerRole.item);F.ariaState("selected","false");F.ariaState("disabled","false");c.data(c.data(G[0],"fluid.reorderer.selectable-initialised",true))}}if(!A.selectableContext){A.selectableContext=d.selectable(A.container,{selectableElements:F,selectablesTabindex:A.options.selectablesTabindex,direction:null})}};var w=function(F){d.moveDom(o,F.element,F.position);o.css("display","");if(x){if(F.lockedelem){x.show()}else{x.hide()}}};var q=function(){var I=A.dom.fastLocate("movables");var H=A.dom.fastLocate("dropTargets");B();for(var F=0;F<I.length;F++){var G=I[F];if(!c.data(G,"fluid.reorderer.movable-initialised")){s(c(G));c.data(G,"fluid.reorderer.movable-initialised",true)}}if(I.length>0&&!o){o=p(I[0].tagName)}t.updateGeometry(A.layoutHandler.getGeometricInfo());t.dropChangeFirer.addListener(w,"fluid.Reorderer");H.ariaState("dropeffect","none")};if(A.container){g(A.container,A.handleKeyDown,A.handleKeyUp);j(A);d.tabbable(A.container);q()}if(m.afterMoveCallbackUrl){A.events.afterMove.addListener(function(){var F=A.layoutHandler;var G=F.getModel?F.getModel():m.acquireModel(A);c.post(m.afterMoveCallbackUrl,JSON.stringify(G))},"postModel")}A.events.onHover.addListener(y,"style");A.refresh=function(){A.dom.refresh("movables");A.dom.refresh("selectables");A.dom.refresh("grabHandle",A.dom.fastLocate("movables"));A.dom.refresh("stylisticOffset",A.dom.fastLocate("movables"));A.dom.refresh("dropTargets");A.events.onRefresh.fire();q();A.selectableContext.selectables=A.dom.fastLocate("selectables");A.selectableContext.selectablesUpdated(A.activeItem)};A.refresh();return A};d.reorderer.keys={TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:19,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,i:73,j:74,k:75,m:77};d.reorderer.defaultKeysets=[{modifier:function(k){return k.ctrlKey},up:d.reorderer.keys.UP,down:d.reorderer.keys.DOWN,right:d.reorderer.keys.RIGHT,left:d.reorderer.keys.LEFT},{modifier:function(k){return k.ctrlKey},up:d.reorderer.keys.i,down:d.reorderer.keys.m,right:d.reorderer.keys.k,left:d.reorderer.keys.j}];d.reorderer.roles={GRID:{container:"grid",item:"gridcell"},LIST:{container:"list",item:"listitem"},REGIONS:{container:"main",item:"article"}};var e=function(k,l,m){m=m||{};m.layoutHandler=l;return d.reorderer(k,m)};d.reorderList=function(k,l){return e(k,"fluid.listLayoutHandler",l)};d.reorderGrid=function(k,l){return e(k,"fluid.gridLayoutHandler",l)};d.reorderer.GEOMETRIC_STRATEGY="projectFrom";d.reorderer.LOGICAL_STRATEGY="logicalFrom";d.reorderer.WRAP_LOCKED_STRATEGY="lockedWrapFrom";d.reorderer.NO_STRATEGY=null;d.reorderer.relativeInfoGetter=function(l,n,m,k,o){return function(q,s,p){var r=d.directionOrientation(s);var t=r===l?n:m;return t!==null?k[t](q,s,p):null}};d.defaults("fluid.reorderer",{styles:{defaultStyle:"orderable-default",selected:"orderable-selected",dragging:"orderable-dragging",mouseDrag:"orderable-dragging",hover:"orderable-hover",dropMarker:"orderable-drop-marker",avatar:"orderable-avatar"},selectors:{dropWarning:".drop-warning",movables:".movables",grabHandle:"",stylisticOffset:""},avatarCreator:b,keysets:d.reorderer.defaultKeysets,layoutHandler:{type:"fluid.listLayoutHandler"},events:{onShowKeyboardDropWarning:null,onSelect:null,onBeginMove:"preventable",onMove:null,afterMove:null,onHover:null,onRefresh:null},mergePolicy:{keysets:"replace","selectors.selectables":"selectors.movables","selectors.dropTargets":"selectors.movables"}});function h(k,m,l){return function(){return{sentinelize:m,extents:[{orientation:k,elements:l.fastLocate("dropTargets")}],elementMapper:function(n){return c.inArray(n,l.fastLocate("movables"))===-1?"locked":null}}}}d.defaults(true,"fluid.listLayoutHandler",{orientation:d.orientation.VERTICAL,containerRole:d.reorderer.roles.LIST,selectablesTabindex:-1,sentinelize:true});d.listLayoutHandler=function(l,m,k,o){var n={};n.getRelativePosition=d.reorderer.relativeInfoGetter(m.orientation,d.reorderer.LOGICAL_STRATEGY,null,k,o);n.getGeometricInfo=h(m.orientation,m.sentinelize,o);return n};d.defaults(true,"fluid.gridLayoutHandler",{orientation:d.orientation.HORIZONTAL,containerRole:d.reorderer.roles.GRID,selectablesTabindex:-1,sentinelize:false});d.gridLayoutHandler=function(l,m,k,o){var n={};n.getRelativePosition=d.reorderer.relativeInfoGetter(m.orientation,d.reorderer.LOGICAL_STRATEGY,d.reorderer.GEOMETRIC_STRATEGY,k,o);n.getGeometricInfo=h(m.orientation,m.sentinelize,o);return n}})(jQuery,fluid_0_8);fluid_0_8=fluid_0_8||{};(function(b,a){a.reorderLayout=function(c,f){var e={layoutHandler:"fluid.moduleLayoutHandler",selectors:{columns:".columns",modules:".modules"}};var d=b.extend(true,e,f);return a.reorderer(c,d)}})(jQuery,fluid_0_8);fluid_0_8=fluid_0_8||{};fluid.moduleLayout=fluid.moduleLayout||{};(function(c,b){var e=function(g,f){return b.find(f.columns,function(j,i){var h=c.inArray(g,j.elements);return h===-1?null:{columnIndex:i,itemIndex:h}},{columnIndex:-1,itemIndex:-1})};var a=function(g,f){return b.find(f.columns,function(i,h){return g===i.container?h:null},-1)};b.moduleLayout.updateLayout=function(i,k,g,h){i=b.unwrap(i);k=b.unwrap(k);var f=e(i,h);h.columns[f.columnIndex].elements.splice(f.itemIndex,1);var m;if(g===b.position.INSIDE){m=h.columns[a(k,h)].elements;m.splice(m.length,0,i)}else{var l=e(k,h);m=h.columns[l.columnIndex].elements;g=b.normalisePosition(g,f.columnIndex===l.columnIndex,l.itemIndex,f.itemIndex);var j=g===b.position.BEFORE?0:1;m.splice(l.itemIndex+j,0,i)}};b.moduleLayout.layoutFromFlat=function(f,h,g){var i={};i.container=f;i.columns=b.transform(h,function(j){return{container:j,elements:c.makeArray(g.filter(function(){return b.dom.isContainer(j,this)}))}});return i};b.moduleLayout.layoutFromIds=function(f){return{container:b.byId(f.id),columns:b.transform(f.columns,function(g){return{container:b.byId(g.id),elements:b.transform(g.children,b.byId)}})}};b.moduleLayout.layoutToIds=function(f){return{id:b.getId(f.container),columns:b.transform(f.columns,function(g){return{id:b.getId(g.container),children:b.transform(g.elements,b.getId)}})}};var d=function(g,f){if(f){var h=c(g).offset();f=c(f);f.css("position","absolute");f.css("top",h.top);f.css("left",h.left)}};b.defaults(true,"fluid.moduleLayoutHandler",{orientation:b.orientation.VERTICAL,containerRole:b.reorderer.roles.REGIONS,selectablesTabindex:0,sentinelize:true});b.moduleLayoutHandler=function(g,n,j,h){var k={};function m(){var p;if(n.selectors.modules){p=b.moduleLayout.layoutFromFlat(g,h.locate("columns"),h.locate("modules"))}if(!p){var o=b.model.getBeanValue(n,"moduleLayout.layout");b.moduleLayout.layoutFromIds(o)}return p}var i=m();k.layout=i;function f(o){var p=n.selectors.lockedModules?h.fastLocate("lockedModules"):[];return c.inArray(o,p)!==-1}k.getRelativePosition=b.reorderer.relativeInfoGetter(n.orientation,b.reorderer.WRAP_LOCKED_STRATEGY,b.reorderer.GEOMETRIC_STRATEGY,j,h);k.getGeometricInfo=function(){var s=[];var r={extents:s,sentinelize:n.sentinelize};r.elementMapper=function(t){return f(t)?"locked":null};for(var o=0;o<i.columns.length;o++){var q=i.columns[o];var p={orientation:n.orientation,elements:c.makeArray(q.elements),parentElement:q.container};s.push(p)}return r};function l(o){return function(){var p=b.accumulate(i.columns,function(q,r){return r.concat(q.elements)},[]);if(!o){b.remove_if(p,f)}return p}}k.returnedOptions={selectors:{movables:l(false),dropTargets:l(false),selectables:l(true)},listeners:{onMove:function(o,p){b.moduleLayout.updateLayout(o,p.element,p.position,i)},onRefresh:function(){i=m();k.layout=i},"onShowKeyboardDropWarning.setPosition":d}};k.getModel=function(){return b.moduleLayout.layoutToIds(i)};return k}})(jQuery,fluid_0_8);