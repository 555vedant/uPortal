<!DOCTYPE HTML PUBLIC "-//SoftQuad Software//DTD HoTMetaL PRO 6.0::19990601::extensions to HTML 4.0//EN" "hmpro6.dtd">
<HTML> 
<HEAD> 
<TITLE>Microsoft SQL Server configuration</TITLE> 
<LINK HREF="../uportal.css" REL="stylesheet">

</HEAD> 
<BODY BGCOLOR="#FFFFFF"> 
<TABLE CELLSPACING="0" CELLPADDING="0" WIDTH="100%"> 
<TR> 
<TD ALIGN="LEFT" VALIGN="BOTTOM" COLSPAN="3"><IMG SRC="../images/uportal-head.gif" ALT="uPortal by JA-SIG" BORDER="0" HEIGHT="87" WIDTH="592"></TD> 
</TR> 
<TR> 
<TD><IMG SRC="../images/spacer.gif" ALT="." BORDER="0" HEIGHT="4" WIDTH="1"></TD> 
</TR> 
</TABLE>

<TABLE CELLSPACING="0" CELLPADDING="5" WIDTH="100%" BORDER="0"> 
   <TBODY> 
   <TR> 
   <TD VALIGN="TOP" WIDTH="150" BGCOLOR="#CCCCFF">
   <IMG SRC="../images/spacer.gif" BORDER="0" HEIGHT="4"><BR/>
   <P><A CLASS="sidelinks" HREF="http://www.ja-sig.org/" ><B> JA-SIG Home</B></A></P>
   <P><A CLASS="sidelinks"  HREF="../index.html" ><B> About uPortal</B></A></P>
   <P><A CLASS="sidelinks" HREF="../docs.html" ><B> Documentation</B></A></P>
   <P><A CLASS="sidelinks" HREF="../administrators/index.html" ><B> Getting Started</B></A></P>
   <P><A CLASS="sidelinks" HREF="../developers/index.html" ><B> Developers</B></A></P>
	<P><A CLASS="sidelinks" HREF="../implementors/index.html" ><B> Implementors</B></A></P>
	<P><A CLASS="sidelinks" HREF="../users/index.html" ><B> Users</b></A></P>
   <P><A CLASS="sidelinks" HREF="../architecture/index.html" ><B> Background</B></A></P>
   <P><A CLASS="sidelinks" HREF="../release/index.html" ><B> Release</B></A></P>
   <P><A CLASS="sidelinks" HREF="../meetings/index.html" ><B> Meetings</B></A></P>
   <P><IMG SRC="../images/mellon.gif" ALT="" BORDER="0" WIDTH="145" HEIGHT="93"></P> 
   </TD>

<!-- main body goes in this table cell -->
   <TD valign="top">
   <IMG HEIGHT="4" WIDTH="692" SRC="../images/orange-pixel.gif" BORDER="0" ALT=".">
   

   <h4 class="title"> <a name="top"></a> Setting up A Microsoft SQL Server Database</h4>
  
<h5> Overview </h5>
 
<p>Microsoft SQL Server (MSSQL) is a commercial database product available from 
Microsoft at<br/>
<a href="http://www.microsoft.com/sql/default.asp">http://www.microsoft.com/sql/default.asp 
</a></p>
<h5>Obtaining the Driver </h5>
<p>
Based on several recommendations, the jTDS driver appears to be the best driver for Microsoft SQL Server.  The driver may be downloaded from the
<a href="http://jtds.sourceforge.net">jTDS Project Site</a>
</p>
<p>Once the zipfile for the driver has been downloaded it must be extracted 
and the jar file must be copied to a location accessible from uPortal (for 
example, <tt>/usr/local/java/jtds/lib/jtds-1.0.3.jar</tt>). You may wish to 
copy it to the <tt>lib</tt> directory in the uPortal release.
<h5> Properties Configuration </h5>

   <p>The uPortal <tt>build.properties</tt> may need to be modifed. Find the 
   property called jdbcDriver and change it to point to the MSSQL 
   jar file, for example: </p>   
   
<blockquote><tt> jdbcDriver.jar=./lib/jtds-1.0.3.jar </tt></blockquote> 
   
      
<p> The uPortal <tt>rdbm.properties</tt> file (in the properties directory) may 
need to modified to specify the driver properties. The <tt>rdbm.properties</tt> 
file contains several sample entries. Uncomment (or add) the lines for the MSSQL 
database and make whatever changes necessary to match your local database installation, 
For example: </p>
   
      
<blockquote><tt> #### SQL Server 2000<br/> 
jdbcDriver=net.sourceforge.jtds.jdbc.Driver<br/> 
jdbcUrl=jdbc:jtds:sqlserver://localhost:1433;DatabaseName=uPortal;SelectMethod=Cursor; <br/>
jdbcUser=sa<br/>
jdbcPassword= </tt></blockquote> 
   
<p>The <tt>dbloader.xml</tt> properties file (in the properties/db directory) 
may also need to be modified. This file is used by the DbLoader tool to create 
the uPortal database tables and populate the database. It contains several sample 
entries which create db-type-mappings for different databases. Find the tags for 
an HypersonicSQL database and modify the db-version, driver-name, and driver-version 
as necessary. For example: </p> 
   

   
<blockquote>
<tt>
&lt;db-type-mapping&gt; 
    &lt;db-name&gt;Microsoft SQL Server 2000&lt;/db-name&gt; 
    &lt;db-version&gt;8.00.760&lt;/db-version&gt; 
    &lt;driver-name&gt;SQLServer&lt;/driver-name&gt; 
    &lt;driver-version&gt;2.2.0040&lt;/driver-version&gt; 
    &lt;type&gt;&lt;generic&gt;INTEGER&lt;/generic&gt;&lt;local&gt;INTEGER&lt;/local&gt;&lt;/type&gt; 
    &lt;type&gt;&lt;generic&gt;VARCHAR&lt;/generic&gt;&lt;local&gt;VARCHAR&lt;/local&gt;&lt;/type&gt; 
    &lt;type&gt;&lt;generic&gt;LONGVARCHAR&lt;/generic&gt;&lt;local&gt;LONGVARCHAR&lt;/local&gt;&lt;/type&gt; 
    &lt;type&gt;&lt;generic&gt;SQL_VARIANT&lt;/generic&gt;&lt;local&gt;VARCHAR&lt;/local&gt;&lt;/type&gt;         
    &lt;!-- map more types here --&gt; 
&lt;/db-type-mapping&gt; 
</tt></blockquote>
      
<p class="content"> The PersonDirs.xml file (also in the properties directory) 
may need to be modified; This file is used if the database is to be used to provide 
user directory information</p>
   
<blockquote><tt> &lt;!-- JDBC Properties --&gt;<br>
&lt;driver&gt;jdbcDriver=net.sourceforge.jtds.jdbc.Driver&lt;/driver&gt;<br>
&lt;url&gt;jdbc:jtds:sqlserver://localhost:1433;DatabaseName=uPortal;SelectMethod=Cursor; &lt;/url&gt;<br>
&lt;logonid&gt;sa&lt;/logonid&gt;<br>
&lt;logonpassword&gt;&lt;/logonpassword&gt;,<br>
&lt;uidquery&gt;SELECT FIRST_NAME||' '||LAST_NAME AS FIRST_LAST,<br>
FIRST_NAME, LAST_NAME, EMAIL FROM UP_PERSON_DIR WHERE USER_NAME=?&gt;&lt;/uidquery&gt; 
</tt></blockquote>
   <h5> Loading the Database </h5>
<p>
   Loading the database requires a couple of steps
   </p>
	<ul>
   
<li>Create the database: Refer to the Microsoft SQL Server database documentation 
for instructions regarding how to create an MSSQL database instances. The database 
name, port number, and driver information must reflect what was defined in the 
<tt>rdbm.properties</tt> file. </li>
   <li>Create the tables and populate the database: From the uPortal build 
   directory, run "ant db" to execute the ant target which loads the 
   database. The ant target uses the Dbloader tool. 
   </li>
	</ul>
   
<h5> Issues and Known Bugs </h5>
<h5><IMG HEIGHT="4" WIDTH="692" SRC="../images/orange-pixel.gif" BORDER="0" ALT="."> 
</h5>
</TD> 

</TR> 

</TBODY> 
</TABLE>

<!-- page footer -->
<TABLE CELLSPACING="0" CELLPADDING="0" WIDTH="100%"> 
   <TBODY> 
   <TR> 
   <TD ALIGN="CENTER">&nbsp;</TD> 
   </TR> 
   
   <TR> 
   <TD ALIGN="CENTER"><IMG HEIGHT="3" SRC="../images/spacer.gif" WIDTH="1"
   BORDER="0" ALT="."><BR><FONT FACE="Verdana, Arial, sans-serif"
   SIZE="1"><A HREF="http://www.ja-sig.org/">JA-SIG Home</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   <A HREF="../index.html"> About uPortal</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   <A HREF="../faq.html">FAQ</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   <A HREF="../download.html">Download</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   <A HREF="../docs.html">Documentation</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   <A HREF="../getinv.html">Getting Involved</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   <BR><A HREF="../cvs.html">Code Repository</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   <A HREF="../bugs.html">Reporting Bugs</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   <A HREF="../license.html">License</A>
   <IMG HEIGHT="13" ALT="*" SRC="../images/diamond-lo.gif" WIDTH="8" BORDER="0">
   </FONT></TD> 
   </TR> 
   </TBODY> 
</TABLE><!-- end page footer -->
</BODY>
</HTML>
