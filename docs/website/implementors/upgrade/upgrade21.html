<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Upgrading uPortal</title>
  <link href="../../uportal.css" rel="stylesheet">
</head>
<body style="background-color: rgb(255, 255, 255);">
<table cellpadding="0" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td colspan="3" align="left" valign="bottom"><img
 src="../../images/uportal-head.gif" alt="uPortal by JA-SIG" border="0"
 height="87" width="592"></td>
    </tr>
    <tr>
      <td><img src="../../images/spacer.gif" alt="." border="0" height="4"
 width="1"></td>
    </tr>
  </tbody>
</table>
<table border="0" cellpadding="5" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td bgcolor="#ccccff" valign="top" width="150"> <img
 src="../../images/spacer.gif" border="0" height="4"><br>
      <p><a class="sidelinks" href="http://www.ja-sig.org/"><b> JA-SIG
Home</b></a></p>
      <p><a class="sidelinks" href="../../index.html"><b> About uPortal</b></a></p>
      <p><a class="sidelinks" href="../../docs.html"><b> Documentation</b></a></p>
      <p><a class="sidelinks" href="../../administrators/index.html"><b>Getting
Started</b></a></p>
      <p><a class="sidelinks" href="../../developers/index.html"><b>Developers</b></a></p>
      <p><a class="sidelinks" href="../index.html"><b> Implementors</b></a></p>
      <p><a class="sidelinks" href="../../users/index.html"><b> Users</b></a></p>
      <p><a class="sidelinks" href="../../architecture/index.html"><b>Background</b></a></p>
      <p><a class="sidelinks" href="../../release/index.html"><b> Release</b></a></p>
      <p><img src="../../images/mellon.gif" alt="" border="0" height="93"
 width="145"></p>
      </td>
<!-- main body goes in this table cell --> <td valign="top"> <img
 src="../../images/orange-pixel.gif" alt="." border="0" height="4"
 width="692">
      <h2>Upgrading uPortal 2.1 to uPortal 2.3/2.4</h2>
      <h3>Database migration<br>
      </h3>
      <ol>
        <li>Modify<code> properties/db/tables.xml</code> by commenting
out <code>UP_ENTITY_CACHE_INVALIDATION</code> "<code>not null</code>"
constraint on the <code>ENTITY_CACHE_ID</code> column. You need to
comment out the <code>not null</code> constraint because it's not
supported by all databases in alter table commands. Later you should
add this constraint back.</li>
        <li>Run <code>ant -f upgrade21.xml</code>.&nbsp; This will
upgrade the database to the 2.3/2.4 schema version, make any necessary
data changes, perform internationalization modifications, and publish
the site map. </li>
        </>
      </ol>
      <h3>Switching from Simple Layouts to Aggregated Layouts (optional)<br>
      </h3>
      <ol>
        <li>Configure <code>portal.properties </code>to use
aggregated versions of the layout manager and layout store:<br>
          <br>
          <code>org.jasig.portal.UserLayoutStoreFactory.implementation=org.jasig.portal.layout.AggregatedUserLayoutStore<br>
org.jasig.portal.layout.UserLayoutManagerFactory.coreImplementation=org.jasig.portal.layout.AggregatedLayoutManager<br>
          <br>
          </code></li>
        <li>Turn off the locale manager awareness in <code>portal.properties</code>:<br>
          <br>
          <code>org.jasig.portal.i18n.LocaleManager.locale_aware=false<br>
          <br>
          </code></li>
        <li>Configure pushfragments.xml (uPortal 2.3) or fragments.xml
(uPortal 2.4) with the fragments you want in your portal.</li>
        <li>Run <code> ant -f upgrade21.xml convert-to-al</code></li>
        <li>Turn locale manager awareness back on (reverse Step 2) if
necessary.</li>
      </ol>
      </td>
    </tr>
  </tbody>
</table>
<!-- page footer -->
<table cellpadding="0" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td align="center">&nbsp;</td>
    </tr>
    <tr>
      <td align="center"><img src="../../images/spacer.gif" alt="."
 border="0" height="3" width="1"><br>
      <font face="Verdana, Arial, sans-serif" size="1"><a
 href="http://www.ja-sig.org/">JA-SIG Home</a> <img alt="*"
 src="../../images/diamond-lo.gif" border="0" height="13" width="8"> <a
 href="../../index.html"> About uPortal</a> <img alt="*"
 src="../../images/diamond-lo.gif" border="0" height="13" width="8"> <a
 href="../../faq.html">FAQ</a> <img alt="*" src="../../images/diamond-lo.gif"
 border="0" height="13" width="8"> <a href="../../download.html">Download</a>
      <img alt="*" src="../../images/diamond-lo.gif" border="0" height="13"
 width="8"> <a href="../../docs.html">Documentation</a> <img alt="*"
 src="../../images/diamond-lo.gif" border="0" height="13" width="8"> <a
 href="../../getinv.html">Getting Involved</a> <img alt="*"
 src="../../images/diamond-lo.gif" border="0" height="13" width="8"> <br>
      <a href="../../cvs.html">Code Repository</a> <img alt="*"
 src="../../images/diamond-lo.gif" border="0" height="13" width="8"> <a
 href="../../bugs.html">Reporting Bugs</a> <img alt="*"
 src="../../images/diamond-lo.gif" border="0" height="13" width="8"> <a
 href="../../license.html">License</a> <img alt="*"
 src="../../images/diamond-lo.gif" border="0" height="13" width="8"> </font></td>
    </tr>
  </tbody>
</table>
<!-- end page footer -->
</body>
</html>
