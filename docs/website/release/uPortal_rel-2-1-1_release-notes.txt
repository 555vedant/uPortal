uPortal 2.1.1 Distribution
--------------------------

Purpose
-------
This distribution is targeted towards
people who would like to install
uPortal in a development or production 
environment.  It contains uPortal source
code and properties files, but not a servlet
container, directory, or relational database, 
which are required.  Use of this distribution
requires knowledge of J2EE environments and the
Ant tool from the Apache Jakarta project.


Contents
--------
1) uPortal 2.1.1
2) uPortal 2.1.1 java libraries (Xalan, Log4J, etc).
3) uPortal Architecture overview and JavaDoc API
   (see docs directory)


System requirements
-------------------
JDK 1.3 or higher
JAVA_HOME environment variable must be set
Installation of Ant from Jakarta: 
  http://jakarta.apache.org/ant


Instructions
------------
Modify build.properties with local settings.

Use the following ant targets:

deploy - installs uPortal into a servlet container
db - prepares a relational database with uPortal schema
     and data
dist - creates JavaDoc, uPortal jar, and uPortal WAR files.

For descriptions of other Ant targets, 
see docs/uPortal_tools_overview.txt.

Make sure the database and servlet container are running and
access uPortal with http://localhost:8080/uPortal
Your URL may be different if you have configured a different port
and/or context name.

You can login to uPortal with the following user name/password 
combinations:

demo, demo
student, student
faculty, faculty
staff, staff
developer, developer

Each user may have a slightly different layout.


Notes 
-----
-Several properties files and database tables have changed
 since uPortal 2.0.x.  If you are upgrading from this version,
 you will need to see to it that your properties files and
 database schema AND data are upgraded appropriately.  
 An upgrade tool is included and can be launched using the 
 following ant command:

 IMPORTANT: First make sure to backup your original database!!!
 
 ant -f convert.xml all

 See the uPortal website to get the latest
 version of the upgrade tool.

-uPortal does not strictly require the use of connection
 pooling, but it is highly recommended for production
 installations.  If your servlet container does not provide
 connection pooling, try something like Poolman.  
 For information about Poolman, see http://www.codestudio.com.

-Bug fixes from 2.0.x releases have been implemented in 2.1.1
 whenever they were appropriate

Please report bugs and suggestions:

 http://mis105.mis.udel.edu/bugzilla/

uPortal website:

 http://www.udel.edu/uPortal


Changes since uPortal 2.1
-------------------------
Database:

-Added new row to UP_ENTITY_TYPE table:
  ENTITY_TYPE_ID=6
  ENTITY_TYPE_NAME=org.jasig.portal.services.entityproperties.EntityProperties 
  DESCRIPTIVE_NAME=Property Lookup Results


Properties:

(No Changes)
 

Bug fixes:

-Groups manager channel
 Fix to avoid a NullPointerException when deleting a group from a search element.
 Fixed access to Permissions Manager servant.
 Fixed group locking: if user logged out without unlocking group, another user could not establish a lock until the first lock timed out.
 Prevented NullPointerException when expanding root group element.
 Add new mode to support intended operation of add/remove servant.
 Return empty Object[] rather than null from getResults() method.
 Fixed bug in xpath that prevented some permissions from being properly evaluated in main_html.xsl.
-Permissions manager channel
 Permissions Manager no longer writes permissions to UP_PERMISSIONS table for 'admin' user.
 Made it possible to assign permissions to view, select or assign permissions on any non-editable group (such as those coming from LDAP)
 An attempt to assign permissions on groups not under one of the default root groups no longer fails.
 The buttons to switch between "Assign by Principal" and "Assign by Owner" are now working in permissions manager servant mode.
-Groups
 Delete user code no longer removes a user's non-local containing groups.
 Lock template groups before adding new user - bug 1252.
 Synchronize memberships of members and containing groups for a deleted group - bug 1273.
-Permissions
 Fix DefaultPermissionPolicy.permissionIsGranted() effective date checking logic.
-Upgrade tool
 Fix case of XML file names referenced from RunXSLT stylesheets.
 Correct error leaving out creator id when not a portal user_id in UP_GROUP.xsl
-Fix bugs during entity lock renewal and lock finalization.
-Fixed exception in entity cacheing and locking when using Oracle - bug 1256.
-Got rid of the extra '>' character showing up at the bottom of the page - bug 1235.
-Changed output of DbUnload tool so that table and column names are forced to be upper case.
-Corrected spacing and spelling mistake in "new channel" screen of preferences - bug 1258. 
-Fixed setting of renderingAsRoot parameter in channel runtime data for IPrivileged channels - bug 1253. 
-Fixed problem with channel subscription list showing unauthorized channels - bug 1263.
-Removed duplicate chaching of group members in Authorization service - bug 1266.
-Closed streams that were left open in ResourceLoader, StylesheetSet, AuthorizationService, InitialSecurityContextFactory, and MediaManager.
-Removed html and body tags from CChannelManager html stylesheet.
-Trimmed whitespace off username in AuthenticationServlet - bug 1224.
-RDBMServices no longer requires the file rdbm.properites to exist when using jndi connections- bug 1248.
-Added unknown entity types to Entity Type store if necessary - bug 1274.
-Fixed SSL LDAP connection problems - bug 1270.
-Fixed deleteUser build target in build.xml for JDK 1.4 - bug 1275.
-Made sure that most recently approved channel definition is returned by RDBMChannelRegistryStore when there is more than one channel for a given fname - bug 1271.
-Fixed CookieCutter which did not read cookies properly where path contains 'port' - bug 1262.
-Fixed a URL-rewriting bug where the <base> element was being ignored when determining relative URLs - bug 1272.
-JTidy's character encoding is no longer contrained to ASCII - bug 1261.
-Fixed path to transparent images in skinList.xsl - bug 1255.
-Fixed empty screen when requested tab doesn't exist - bug 1264.
-Added error message in CChannelManager when user tries to publish a channel without first assigning categories and groups - bug 1249.
-Rethrew exceptions in LDAP security providers - bug 1259.


Other changes:

-In XSLT.transform(), set the recorded exception in the thrown exception allowing caller to report the actual error
-Added setBaseUrl() method to AbsoluteURLFilter class.
 

