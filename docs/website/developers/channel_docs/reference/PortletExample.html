<html>
<head>
<title>uPortal Portlet Example</title>
<link href="../../../uportal.css" rel="stylesheet">
</head>
<body bgcolor="#ffffff"> 
<table cellspacing="0" cellpadding="0" width="100%"> 
   <tr> 
      <td align="left" valign="bottom" colspan="3"><img src="../../../images/uportal-head.gif" alt="uPortal by JA-SIG" border="0" height="87" width="592"></td> 
   </tr> 
   <tr> 
      <td><img src="../../images/spacer.gif" alt="." border="0" height="4" width="1"></td> 
   </tr> 
</table> 
<table cellspacing="0" cellpadding="5" width="100%" border="0"> 
   <tr> 
      <td valign="TOP" width="150" bgcolor="#CCCCFF"> <img src="../../../images/spacer.gif" border="0" height="4"><br/> 
         <p><a class="sidelinks" href="http://www.ja-sig.org/" ><B> JA-SIG Home</B></a></p> 
         <p><a class="sidelinks"  href="../../../index.html" ><B> About uPortal</B></a></p> 
         <p><a class="sidelinks" href="../../../docs.html" ><B> Documentation</B></a></p> 
         <p><a class="sidelinks" href="../../../administrators/index.html" ><B> Getting Started</B></a></p> 
         <p><a class="sidelinks" href="../../index.html" ><B> Developers</B></a></p> 
         <p><a class="sidelinks" href="../../../architecture/index.html" ><B> Architecture</B></a></p> 
         <p><a class="sidelinks" href="../../../users/index.html" ><B> Users</b></a></p> 
         <p><a class="sidelinks" href="../../../release/index.html" ><B> Release</B></a></p> 
         <p><img src="../../../images/mellon.gif" alt="" border="0" width="145" height="93"></p></td> 
      <!-- main body goes in this table cell --> 
      <td> <img height="4" width="692" src="../../../images/orange-pixel.gif" border="0" alt=".">         
		<p class="subhead1">Portlet Example</p>
		<p class="subhead2">Purpose: To demonstrate how to create a Portlet for uPortal 2.3.*/2.4.*.</p>
		<p>For this example, we will be creating 3 files directly. Our root directory will be			<I>/example</I>. The files we need are as follows:</p>
<pre>
  - /example/WEB-INF/classes/helloworld/HelloWorld.java
  - /example/WEB-INF/web.xml
  - /example/WEB-INF/portlet.xml
</pre>
<p>Please note: <em>$TOMCAT_HOME </em>refers to the root directory where Tomcat is installed in 
and <em>$UPORTAL_HOME </em>refers to uPortal's <strong>SRC </strong> root directory (E.G. if you 
download the quick-start, this directory would be <em>&lt;basedir&gt;/uPortal_2-3-4-quick-start/uPortal_rel-2-3-4).</em>
This walkthrough also assumes you have ANT installed. </p>
<p class="subhead2">Create and compile the HelloWorld class</p>	
<p align="center">HelloWorld.java</p>
<pre style="background-color:#EEEEEE">	
package helloworld;
import javax.portlet.*; 
import java.io.*; 

public class HelloWorld extends GenericPortlet { 
   public void doView(RenderRequest request,RenderResponse response) 
      throws PortletException,IOException { 

      // Get our preferences
      PortletPreferences pref = request.getPreferences();

      // Get the value of "displaytext" from our preferences, if not available,
      // then use the second string passed to the function
      String displayText = pref.getValue("displaytext", "MISSING: display-text");
      // displays the string from our preferences

      response.setContentType(request.getResponseContentType()); 
      PrintWriter writer = response.getWriter(); 
      writer.write(displayText); 
   } 
}</pre>         
<p>Note: to compile the file, you will need the Portlet library in 
your classpath this should be found in $UPORTAL_HOME/lib/portlet-api-1.0.1.jar</p>
   
<p>
This file needs to be compiled such that the class resides in the same 
directory as our source file (this was done for simplicity).</p>
   
<p class="subhead2">Create the web descriptor file</p> 
<p align="center">web.xml</p> 
<pre style="background-color:#EEEEEE ">       
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt; 
&lt;!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" 
   "http://java.sun.com/dtd/web-app_2_3.dtd"&gt;

&lt;web-app&gt;
   &lt;display-name&gt;HelloWorld&lt;/display-name&gt;
   &lt;description>Hello World Portlet&lt;/description&gt;

   &lt;!-- The security role is something SUN says should be included, but causes
   problems with uPortal, so Ive commented it out.
   &lt;security-role&gt;
   &lt;role-name>user&gt;/role-name>
   &lt;/security-role&gt;
   --&gt;

&lt;/web-app&gt;
</pre> 

 

 
<p>I dont know what everything means here or why its necessary but I can say that display-name is 
modifiable to fit your application.</p>

<p class="subhead2">Create the Portlet descriptor file</p>
<p align="center">portlet.xml</p>
<pre style="background-color:#EEEEEE">
&lt;xml version="1.0" encoding="UTF-8"?&gt;
&lt;portlet-app xmlns="http://java.sun.com/xml/ns/portlet/portlet-app_1_0.xsd" version="1.0"&gt; 
   &lt;portlet&gt; 
      &lt;portlet-name&gt;HelloWorld&lt;/portlet-name&gt; 
      &lt;portlet-class&gt;helloworld.HelloWorld&lt;/portlet-class&gt; 
      &lt;expiration-cache&gt;0&lt;/expiration-cache&gt; 
      &lt;supports&gt; 
         &lt;mime-type&gt;text/html&lt;/mime-type&gt; 
         &lt;portlet-mode&gt;VIEW&lt;portlet-mode&gt; 
      &lt;/supports&gt; 
      &lt;supported-locale&gt;en&lt;/supported-locale&gt;
      &lt;portlet-info&gt; 
         &lt;title&gt;HelloWorld&lt;/title&gt; 
         &lt;keywords&gt;Hello, world, test&lt;/keywords&gt;
      &lt;/portlet-info&gt;
      &lt;portlet-preferences&gt;
         &lt;preference&gt;
            &lt;name&gt;displaytext&lt;/name&gt;
            &lt;value&gt;Hello, from your preferences&lt;/value&gt;
         &lt;/preference&gt;
      &lt;/portlet-preferences&gt;
   &lt;/portlet&gt;
&lt;/portlet-app&gt; 
</pre> 
<p>This file is important - it specifies Portlet mapping to the class name as 
well initial parameters, various modes it supports, keywords, title, and 
more. Initial parameters are specified in the Portlet-preferences section 
they can also be specified from the portal itself.  uPortal gives the 
ability to specify Portlet preferences when you publish the channels making 
it easier to deploy one class that takes a URL or something of the sort and 
displays a different view based on that. Preferences specified in uPortal 
supersede preferences in the portlet.xml file. This is a relatively minimal 
file, however with simply the class mapping.  All Portlets need to have the 
view mode but are not required to implement anything else.  
</p>

<p class="subhead2">Create the Web Archive (WAR) file and deploy it</p>
<p>This is simply a JAR file with a different extension.</p>

<p>From the <em>/example</em> directory, type: <em>jar cvf helloworld.war *</em></p>


<p>This will give you a WAR file which is used by uPortal and translated 
for use with the Pluto container.</p>


<p>From <em>$UPORTAL_HOME</em> type: <em>ant deployPortletApp -DportletApp=/example/helloworld.war</em></p>

<p>You may need a script file (<em>ant.sh</em> or <em>ant.bat</em>) to get 
it to work properly (on Windows this worked fine, but on Linux I needed the 
script). uPortal has an ANT build target labeled <em>deployPortletApp</em> 
that causes the Portlet to be deployed into the proper location, have a 
couple files added to the structure, and the XML files translated to ones 
that Pluto likes. Assuming everything goes well, you should be able to 
look in your <em>$TOMCAT_HOME/webapps</em> directory and see a new 
directory named <em>helloworld</em>.</p>

<p>Finally, you must publish the Portlet. Start up uPortal, go to the 
Channel Manager, 
select <em>publish a new channel</em> and select Portlet as the type. Most of the 
parameters are relatively self-explanatory and can be filled in easily
just make sure that the Portlet Definition ID is correct for our example 
this needs to be <em>helloworld.HelloWorld</em>. (context-path.portlet-name). 
After all the other parameters are done, just add the Portlet as you 
would any other channel. 
</p>
 

<p>More information may be found here:</p>

<a href="http://www.uportal.org/implementors/portlets/workingWithPortlets.html">http://www.uportal.org/implementors/portlets/workingWithPortlets.html</a><Br/>

<a href="http://docs.sun.com/source/817-5319/ch12a.html">http://docs.sun.com/source/817-5319/ch12a.html</a><br/>

<a href="http://developers.sun.com/prodtech/portalserver/reference/techart/jsr168/pb_whitepaper.pdf">http://developers.sun.com/prodtech/portalserver/reference/techart/jsr168/pb_whitepaper.pdf</a><br/>

<a href="http://www.jcp.org/en/jsr/detail?id=168">http://www.jcp.org/en/jsr/detail?id=168</a> <br/>  </tr> 
</table> 
<!-- page footer --> 
<table cellspacing="0" cellpadding="0" width="100%"> 
   <tr> 
      <td align="center">&nbsp;</td> 
   </tr> 
   <tr> 
      <td align="center"><img height="3" src="../../../images/spacer.gif" width="1"
   border="0" alt="."><br/>         <font FACE="Verdana, Arial, sans-serif"
   size="1"><a href="http://www.ja-sig.org/">JA-SIG Home</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> <a href="../../../index.html"> About uPortal</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> <a href="../../../faq.html">FAQ</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> <a href="../../../download.html">Download</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> <a href="../../../docs.html">Documentation</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> <a href="../../../getinv.html">Getting Involved</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> <br/> 
      <a href="../../../cvs.html">Code Repository</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> <a href="../../../bugs.html">Reporting Bugs</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> <a href="../../../license.html">License</a> <img height="13" alt="*" src="../../../images/diamond-lo.gif" width="8" border="0"> </font></td> 
   </tr> 
</table> 
<!-- end page footer --> 
</body>
</html>
