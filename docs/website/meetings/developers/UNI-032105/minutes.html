<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="content-type">
  <title>uPortal Developers' meeting Spring 2005</title>
</head>
<body>
<h2>uPortal Developers' meeting</h2>
March 21-22, 2005 [Monday and Tuesday]<br>
at the offices of Unicon, Inc., El Segundo, CA.<br>
revision of April 24, 2005, 23:45 EDT<br>
<br>
[The static version of the minutes are based on notes taken live by
Michael Oltz, and reviewed by presenters and<br>
other attendees. The subsequent dynamic version is broadly editable,
and likely to reflect ongoing development and debate over the issues as
originally raised.]<br>
<h4>Attendees</h4>
<br>
Duffy Gillman -- <a href="http://www.arizona.edu/">University of
Arizona</a><br>
Dan Ellentuck -- <a href="http://www.columbia.edu/">Columbia University</a><br>
John Fereira -- <a href="http://www.cornell.edu/">Cornell University</a><br>
Michael Oltz -- Cornell University<br>
Sriman Ravi -- <a href="http://www.uga.edu/">University of Georgia</a><br>
Jim Farmer -- <a href="http://www.immagic.com/">instructional media +
magic, inc.</a><br>
Patty Gertz* -- <a href="http://www.princeton.edu/">Princeton</a><br>
Paul Lynn* -- Princeton<br>
William G. Thompson, Jr.* -- <a href="http://www.rutgers.edu/">Rutgers
University</a><br>
Scott Battaglia -- Rutgers University<br>
Chuck Severance -- <a href="http://www.sakaiproject.org/">Sakai</a> - <a
 href="http://www.umich.edu/">University of Michigan</a><br>
Ann Badertscher -- <a href="http://www.sigmasys.com/">Sigma Systems,
Inc.</a><br>
Mark R. Boyd -- <a href="http://www.sct.com/Education/index.html">SunGard
SCT</a><br>
Vishal Goenka -- SunGard SCT<br>
Keith Stacks -- SunGard SCT<br>
Mike Zackrison -- SunGard SCT<br>
Eric Dalquist -- <a href="http://www.unicon.net/">Unicon, Inc.</a><br>
Michael Ivanov -- Unicon, Inc.<br>
Freddy Lopez -- Unicon, Inc.<br>
Cris J. Holdorph -- Unicon, Inc.<br>
Peter Kharchenko -- Unicon, Inc.<br>
Adam Rybicki -- Unicon, Inc.<br>
Doug Gouldin -- Unicon, Inc.<br>
Nicholas Blair -- <a href="http://www.wisc.edu/">University of
Wisconsin - Madison</a><br>
Curt Ellmann -- University of Wisconsin - Madison<br>
Andrew Petro -- <a href="http://www.yale.edu/">Yale University</a><br>
<br>
* [Patty Gertz and Paul Lynn 'attended' by speakerphone for a session
about the JA-SIG Clearinghouse server machine. Bill Thompson 'attended'
by
speakerphone for part of Tuesday afternoon. ]<br>
<br>
<br>
<h4>Useful links of concepts often referred to.</h4>
<a href="http://www.uportal.org/">uPortal homepage</a><br>
<a href="http://jasigch.princeton.edu:9000/homepage.action">uPortal
Confluence</a><br>
<a href="http://mis105.mis.udel.edu/cgi-bin/viewcvs.cgi/">uPortal CVS
archive</a><br>
<a href="http://jasigch.princeton.edu:9000/jira/secure/Dashboard.jspa">uPortal
Jira</a><br>
<a href="http://jasigch.princeton.edu/">JA-SIG Clearinghouse</a><br>
<br>
<a
 href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=wsrp">WSRP</a><br>
<a href="http://jcp.org/en/jsr/detail?id=168">JSR-168</a><br>
<a href="http://www.sakaiproject.org/">Sakai</a><br>
<br>
<h3>MONDAY March 21</h3>
<br>
<h3>uPortal 2.4 performance and memory</h3>
by Scott Battaglia, Rutgers [on behalf of Bill Thompson]<br>
<br>
[These notes are based in part on the <a
 href="http://jasigch.princeton.edu:9000/download/attachments/4793/uPortal+Performance+-+Memory+Issues.ppt?version=1">Powerpoint
presentation</a>, which has more details.]<br>
<br>
we have 10,000 unique users per day, with over 30,000 total logins. We
load balance per session
to 4 machines.<br>
we are seeing a bad memory leak.<br>
eventually uportal stops working properly and hangs<br>
we didn't see this in QA <br>
seen in production since November 2004<br>
Yale, U LA Lafayette, U CA Urvine, Cornell also see this<br>
we bounce portal when available memory goes below 5%<br>
-- may be too aggressive<br>
-- people lose their session<br>
-- if we don't catch it soon enough Apache also goes down<br>
this just makes it barely livable<br>
<br>
fixes they've done so far:<br>
-- removed caching of IPerson<br>
-- CError and CSecureInfo now pass events to wrapped channels (they did
not before; this meant the channels would hang on to objects)<br>
-- restrict access to ChannelFactory's channel cache, and sync
instantiateChannel method<br>
-- guest sessions created on time out<br>
-- AbstractMultithreadedChannels were not cleaning out their channel
state maps<br>
<br>
3 months later --<br>
-- leaks still exist<br>
-- the search continues<br>
<br>
now looking for more leaks<br>
-- retooled load tests<br>
-- production snapshots<br>
-- incremental updates<br>
-- reaffirm that loadtest system matches production system<br>
retooling: attempt to mimic more closely what a user does in prod<br>
-- use more custom layouts in test environment<br>
-- fewer people logging out [only 25 percent formally do that]<br>
-- hitting more popular channels more aggressively<br>
try to match the production throughput<br>
-- imitate average user session length<br>
-- determine rate at which users access system<br>
bought test system with same specs as prod system<br>
-- ensure database optimizations are the same<br>
-- make sure configuration is the same<br>
<br>
take production snapshots<br>
-- JVM heap size initially 2 GB<br>
lowered JVM heap size to 128 MB on machine, allows us to compare
snapshots (on our developer machines which have only 1G. larger
snapshots won't compare)<br>
when memory reaches 10% take that one production server out of load
balancing rotation<br>
garbage collect<br>
capture snapshot<br>
wait past session timeout (15 minutes)<br>
take another snapshot<br>
compare<br>
<br>
-- what objects are still in memory<br>
-- how much memory they are using<br>
-- how much memory things they reference are using<br>
-- they are using <a href="http://www.yourkit.com/">YourKit</a> to
take the snapshots and compare them<br>
<br>
-- YourKit reports incoming and outgoing references<br>
-- totals for objects of each type<br>
-- how much memory they consume<br>
-- allows us to compare snapshots, showing the details of each object
type<br>
<br>
understanding the snapshots<br>
<br>
-- name<br>
-- objects<br>
-- shallow size [object itself]<br>
-- retained size [plus referenced objects]<br>
<br>
can trace the path to the root of the garbage collector<br>
<br>
another practice to get a handle on the problem: incremental updates:<br>
instead of doing massive patches (either Rutgers' local fixes, or from
JA-SIG), we do one little fix at a time, first on the loadtester, then
in production<br>
[Scott gave a couple examples of the minimal fixes]<br>
<br>
there is a flurry of discussion on JASIG-DEV about memory issues<br>
one thing being discussed is to backport the concurrent threadpool<br>
-- there are two other issues in the discussion as potential causes<br>
<br>
The Concurrent Thread Library, because the threadpool has some problems.<br>
<br>
Aaron Hamid at Cornell wrote a patch to replace the thread library<br>
Rutgers manually applied the patch to 2.4.1 into production<br>
This was during spring break.<br>
It seems to have improved performance rather than fixing the leaks.<br>
<br>
AuthorizationImpl<br>
-- retains references to principals<br>
-- no explicit removal of principal from cache<br>
-- whenever a new principal is created it copies the map<br>
<br>
-- Rutgers has a patch for this that they are going to loadtest then
place in production<br>
-- then they will put it in the JA-SIG CVS HEAD<br>
<br>
-- introduced a CacheFactory [generic], an interface. they are trying
out <a href="https://whirlycache.dev.java.net/">WhirlyCache</a><br>
-- -- allows for declaring cache settings and policy in XML<br>
-- -- allows for fine-grained caching strategies for each part of
uPortal.<br>
<br>
General principles<br>
<br>
-- implementing a finalizer should be a last resort<br>
-- consider using an open source solution<br>
-- be aware of proper caching (where is needed vs. not, weak and soft
references, etc.)<br>
-- avoid circular references whenever possible<br>
<br>
Adam: (heard this at last year's Java One) Now that Sun has 3 different
heaps in JVM, caching is not as important as it used to be for
temporary objects.<br>
<br>
Eric: Rutgers is contributing things to HEAD. Looks good. The rest of
us should be careful not to make the same mistakes.<br>
<br>
Peter K.: One problem is you can't replicate this well? Q&amp;A does
not find it? Do you do snapshots in Q&amp;A? You see ChannelRender
instances are being held?<br>
<br>
Scott: Yes, by the finalizer. We are probably going to change so the
thread pool uses explicit calls rather than finalizers.<br>
<br>
Peter K.: How many requests are necessary to saturate the server? Find
that out. Use 'last render time' per user to get an equivalent to
'logout'.<br>
<br>
Scott: We have four machines in the production pool.<br>
<br>
Peter K: Be sure to track how often channels timeout.&nbsp; When you
have a huge memory most of that is objects that can be GC'd. But if you
have only 128M for your experiment, there will be very little. Most of
Peter's comments here relate to trying to figure out why the QA machine
does not experience the problem as clearly, (because if it did the
problem would be easier to solve).<br>
<br>
Eric and Adam questioned whether 128M is enough to realistically run
the portal. Make the heap bigger and see if you can fit it on your
developer system. Scott replied that 128M is big enough to help
diagnose the memory leaks, which is their purpose in the runs in
question.<br>
<br>
Adam: You should try <a href="http://java.sun.com/performance/jvmstat/">visualgc</a>
free from Sun (it is no longer
available for 1.4, only for 1.5 any more).<br>
<br>
Scott: (Adam asked what JVM and parms on it they are using) Solaris,
don't know if we're running in 64bit. They are using the default GC
algorithm, and using Apache. Someone asked how many AJP threads, Scott
didn't know. (are you overriding the default stack size per thread?)
Scott didn't know. [-Xss:threadStackSize=]<br>
<br>
Nick from U. Wisconsin -- been looking into storing sessions into
database (for another application), but Andrew says the uportal session
is not fully serializable AND we need more stuff than just the session
(static caches etc.), so this isn't doable.<br>
<br>
Nick gave a few recommendations<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<h3>uPortal 2.4.x, Future Release, Branch maintenance</h3>
&nbsp;by Andrew Petro, Yale<br>
<br>
[This session regards how the uPortal project uses its <a
 href="http://www.uportal.org/cgi-bin/viewcvs.cgi/">CVS archive</a>]<br>
<br>
[The notes are taken in part from the <a
 href="http://jasigch.princeton.edu:9000/download/attachments/4586/uPcvs2.ppt?version=1">Powerpoint
presentation</a>.]<br>
<br>
This will cover<br>
-- what we currently do<br>
-- our deployer community<br>
-- what we could do<br>
<br>
what we've done<br>
<br>
-- patches for only the current release<br>
-- in up2: One active patches branch, one Head.<br>
<br>
before 2.4 was released, there was:<br>
<br>
-- the current release (2.3.4)<br>
-- the 2-3 patches branch [would become 2.3.5]<br>
-- the HEAD -- would become uportal 2.4<br>
-- the SANDBOX -- uportal 3 pre-M1<br>
<br>
the 2.4 release<br>
<br>
-- head was tagged as 2.4<br>
-- head continues and becomes uPortal 2.5<br>
-- created branch for 2-4-patches<br>
-- stopped adding to 2-3-patches, and stopped releasing further 2-3
releases.<br>
<br>
right now:<br>
<br>
-- the current release (uportal 2.4.2)<br>
-- the 2-4-patches branch<br>
-- the HEAD<br>
-- the SANDBOX<br>
<br>
Andrew made the point that a lot of schools are deployed on older
releases.<br>
<br>
-- we need timely new releases adding functionality we discover we need
and can achieve<br>
-- high quality of releases<br>
-- patches and support for older versions<br>
-- -- there are still questions, problems in uP 2.1<br>
-- -- back-porting of fixes.<br>
<br>
Andrew wants to keep multiple active patches branches.<br>
<br>
Problem -- too many places where progress can be made, the small
developer community becomes diluted.<br>
<br>
Andrew says -- the idea would be, the older patches branches remain
open, but commits and releases will be only in response to
contributions, rather than official.<br>
<br>
Patches branches would dry up naturally when the contributor community
has moved on.<br>
<br>
Adam: Closing older branches was an inducement to encourage people to
keep up to date.<br>
<br>
Jim: Many sites are highly modified, such that it's a big chore to move
up. The original decision was a pragmatic one; it was all that he (Ken)
could manage to do.<br>
<br>
Peter K: The way we did this encourages development and fixes on newer
releases. If we keep the older branches open how would we encourage
people to commit to later ones? (especially without people riding herd
on it like Ken did). If someone commits a patch to an old branch, the
committer should very clearly state that in a particular place. [so
that others can consider the patch for later branches] Open a Jira
issue on the head and latest patches?<br>
<br>
John F: The problem would be, how would they test the newer release if
they have no instance of it? It may actually already be fixed in a
later release, and such a person might not know.<br>
<br>
Andrew: The most appropriate way to track patches against older
releases is to put it in CVS.<br>
<br>
<br>
<br>
<br>
<h3>Spring and uPortal 2.x</h3>
by Andrew Petro, Yale<br>
<br>
[These notes are based in part on the <a
 href="http://jasigch.princeton.edu:9000/download/attachments/4716/uP2Spring.ppt?version=1">Powerpoint
presentation</a> which has more details]<br>
<br>
The problem that the <a href="http://www.springframework.org/">Spring</a>
framework effort addresses is dependencies.<br>
<br>
We developers are addicts to making dependencies -- how do we find all
the other things we need for a particular class to do its work.<br>
<br>
Traditionally we use ("lookup"): JNDI, or servlet context, or a static
object, or use a factory.<br>
<br>
<br>
The more recently introduced way is "Dependency Injection"<br>
<br>
-- your object knows what it needs<br>
-- exposes constructor arguments/ setter methods to fulfill these
dependencies<br>
-- [some other package goes around and resolves them]<br>
-- [therefore,] the object assumes that dependencies have been
fulfilled before it tries to do anything<br>
-- bonus points: fail gracefully if they have not<br>
<br>
Spring as a dependency injector.<br>
You have an XML configuration of the dependencies.<br>
Our IChannel instances, for example, are not Spring-configured.<br>
<br>
In JSR-168<br>
Spring PortletMVC can be used for portlets.<br>
<br>
Our traditional solution is to use portal.properties.<br>
<br>
PersonDirectory reimplemented for uPortal 2.5: it uses Spring so it can
gather up the 'way it works' from various pieces.<br>
<br>
"Using Spring for the sake of using Spring" is not what this is about.
Instead, this is about producing loosely coupled configurable objects.<br>
<br>
A Yale use case: At Yale, there's an XML file available on the web that
defines
e.g. student support people; How can Yale bring that into the IPerson?
By wiring in more code, another source. So instead of having a local
hack, the Spring thing allows you to paste in a wide variety of
implementations.<br>
<br>
PersonDirectory becomes a fa&ccedil;ade in front of the
Spring-configured person attribute Data Access Object (DAO) that allows
the old code to call
PersonDirectory in the traditional way.<br>
<br>
If there were any other Spring-configured objects, they would not need
the fa&ccedil;ade or the static services, they could have Spring inject
their dependencies. Non-Spring-configured objects can use the static
way.<br>
<br>
a proposed way forward:<br>
<br>
more services being Spring-configured when they need to be
significantly touched<br>
<br>
Packaging:<br>
Peter K recommended that this could be spun out as a micro-project
producing a jar<br>
This might ease maintenance: <br>
-- multiple codebases can use this code.<br>
Dan E: Good idea. For example, that would make migration of PAGS
[into 3.0] easier.<br>
<br>
<br>
<br>
<br>
<h3>Distributed Layout Manager integration with base code</h3>
by Mark Boyd of SunGard SCT<br>
<br>
SCT has their own unique layout manager; although it has another name
internally, when discussed for JA-SIG purposes, it's called by its old
name, the Distributed Layout
Manager, called here DLM.<br>
<br>
This will be provided in the base code as an alternative to JA-SIG's
Aggregated Layout Manager (ALM).<br>
<br>
This project has two phases. <br>
<br>
First, the DLM will be added to the base
code with the capabilities it has at present in Luminis' code.<br>
This has only
pushed fragments, configured with an XML file rather than a GUI.<br>
Each fragment is associated with a userid set aside for the purpose. To
configure the contents of the fragment,<br>
the fragment owner logs in to that userid and sets up the tabs,
columns, and so on.<br>
-- this much will be in 2.5. (his part will be done in about 2 weeks
from this meeting)<br>
<br>
Second, a user interface for creating and editing fragments, will be
created for the DLM, based on the code for the present ALM. Pulled
fragments will also be implemented.<br>
<br>
In the XML, the 'audience declaration' describes the authorization
(What is the
audience for this fragment?). Keith
Stacks of SunGard SCT is working on the authorization part [see another
session elsewhere in these minutes].<br>
<br>
Mark demonstrated in <a
 href="http://www.sct.com/Education/products/p_l_index.html">Luminis</a>
(SCT's portal offering) how their DLM layout
works. It has finer grained control for what is locked down in a
fragment, than does the ALM. So a user can add columns or channels to a
pushed fragment if the owner permits it. Preferences can be pushed
along with the fragment. <br>
<br>
It indicates locked down channels, columns, or tabs by graying out
delete buttons and/or leaving out moving buttons.<br>
<br>
for 2.6: they will have their part done in 2 or 3 months<br>
both pushed and pulled fragments<br>
define fragments via UI<br>
new permissions enhancements for defining audiences, differentiating
publishing capabilities.<br>
<br>
Nick (U. Wisconsin) -- they want to roll out with 2.4 but wish they
could use DLM anyhow.<br>
<br>
<br>
2.5 will be out in two or three weeks<br>
2.6 will be out about 6 months later.<br>
<br>
<br>
<br>
<br>
<br>
<h3>uPortal 2.5 release issues</h3>
facilitated by Adam Rybicki<br>
[release schedule or release content]<br>
<br>
what's new?<br>
<br>
-- portlet adapter updates<br>
&nbsp;&nbsp;&nbsp; the adapter was portlet API compliant but there were
some bugs. e.g.<br>
&nbsp;&nbsp;&nbsp; in ProcessAction, one can now programmatically
change the window state of the portlet.<br>
&nbsp;&nbsp;&nbsp; redirects from inside a portlet now work.<br>
&nbsp;&nbsp;&nbsp; we now have expiration caching. (optional feature)<br>
&nbsp;&nbsp;&nbsp; enhancements to Exclusive Window State
implementation [uPortal enhancement]<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; e.g. to support downloads via a
portlet.<br>
-- RDBMServices refactoring<br>
&nbsp;&nbsp;&nbsp; the ant tasks do the db stuff; JNDI can be used only
by the portal itself, and the rdbm.properties are used by the ant tasks.<br>
&nbsp;&nbsp;&nbsp; we need pooled connections -- Eric wrote
RDBMServices to create its own pooled resource when it can't get to
JNDI.&nbsp; therefore
able to check out spooled connections outside of Tomcat. It will now
give you
metadata about the nature of the JDBC connection.<br>
-- Person Directory Spring re-write<br>
&nbsp;&nbsp;&nbsp; had a whole session on that [see above]<br>
-- moved to JAXP XML APIs<br>
&nbsp;&nbsp;&nbsp; Sun has backported these API's from 1.5 to 1.4 so
the API can look the same.<br>
&nbsp;&nbsp;&nbsp; This does not conflict with the old 1.4 API's.<br>
-- JDK1.4 is now a minimum requirement<br>
&nbsp;&nbsp;&nbsp; don't use 1.3 any more, period<br>
-- all exceptions are chained<br>
&nbsp;&nbsp;&nbsp; all through the code. <br>
<br>
<br>
<h5>release topics</h5>
<br>
release management responsibility<br>
-- Rutgers did 2.4.2, can we count on them again for 2.5? Scott from
Rutgers says Bill (who was not able to attend) was kind of expecting
this.<br>
what remains to be completed<br>
-- rewrite of the thread pool -- Doug Lee's actual package<br>
-- about 55 issues in Jira that are targeted to 2.5.<br>
are there critical issues that block the release?<br>
-- memory leaks [is it a critical enough issue?]<br>
release date -- tentatively april 18th<br>
<br>
there was a discussion about whether 2.5 should be held up for the
memory leak fixes because Rutgers and others really want that in the
release, but some people don't want to wait for it to come out because
if it delays too long they couldn't commit it to a fall rollout.<br>
<br>
Dan: What is the real issue here? Are we worried about selling this to
our respective management, or is it a developer concern, we need to do
this by such a date etc.<br>
<br>
Mark Boyd: Why don't the people who have strong feelings about this
work out the issue?<br>
<br>
Cris H (Unicon): From our point of view, it's best to have uPortal
work well on Java 1.5, because what if the memory leak problem has been
fixed in 1.5? So, I recommend we go forward.<br>
<br>
<br>
<br>
<br>
LUNCH BREAK<br>
<br>
<br>
<br>
<br>
<h3>uPortal Clearinghouse</h3>
with Patty Gertz and Paul Lynn from Princeton [via
speakerphone]<br>
<br>
Clearinghouse has two meanings:<br>
<br>
The JA-SIG Clearinghouse application [which has much material related
to uPortal, and some other things]<br>
and the Clearinghouse machine that the application runs on, which was
acquired by a grant from Sun.
Most of Patty's questions today are about the machine.<br>
<br>
It's a Sunfire 280R, 64G disk, 8G ram, 2 processors<br>
Princeton charges an annual fee for hosting a server -- includes
nightly backups, 24 hour monitoring, OS patching. The
first year (well, 18 months) of service was donated by Princeton, but
it is not clear as yet whether this will be an ongoing contribution.<br>
<br>
This is the home of Jira and Confluence. If someone wants to put up
some other app and take full responsibility for maintaining it, that's
okay.<br>
<br>
There are 3 chunks of filesystem space. a production clearinghouse, a
dev clearinghouse, and postgres. Jira and Confluence are both on the
development disk. Right now there's only one Tomcat. She wants there to
be two Tomcats, and move Jira and Confluence to the production
partition. The second Tomcat (dev) is NOT brought up automatically if
it dies or the host reboots.<br>
<br>
Who will do the work? Jason at Rutgers probably.<br>
<br>
Domain names and certs for this server. What do we want to do in terms
of standardizing the JA-SIG domain names? Until this week, they didn't
have incorporation papers.<br>
<br>
Patty prefers<br>
www.ja-sig.org/something<br>
Someone else assumed<br>
something.ja-sig.org<br>
Patty points out that the latter would make it more difficult to get
security certificates (for SSL and site identification).<br>
Group agreed with Patty to do it first way.<br>
<br>
Paul at Princeton asked if we should add more partitions. Our group had
no strong feeling about this.<br>
<br>
Patty: If new tools want to be added, be sure not to put up tools that
require maintenance or licensing fees.<br>
Each tool needs an owner.<br>
Please notify the JA-SIG board [e.g. Patty] that you want to put it on
the
machine.<br>
Provide the license agreement and if it's open source, put the source
itself into the clearinghouse, so that if the tool owner moves on to
other things people will still know why it is there.<br>
Andrew pointed out that the CAS (Central Authorization Service, from
Yale) project might choose to use the machine as their home.<br>
<br>
Patty thought Eric Dalquist was wanting to move other uportal stuff
onto the clearing house machine [but Eric is still not present at this
meeting.]<br>
Delaware which hosts the CVS archive (people at first surmised that was
Eric's concern) doesn't look like they will pull out.<br>
Adam found Eric's notes, he was suggesting the CVS monitor [provides
statistics about the use of a CVS instance] should be moved over to the
Clearinghouse; it is currently hosted at Unicon, but it's on a low
powered machine with no provision for regular updating of the database.
JA-SIG has a license for <a href="http://www.cenqua.com/fisheye/">FishEye</a>
but that would have to run on the same
machine as the CVS.<br>
The group approved of the idea in principle.<br>
<br>
What is the legal entity for JA-SIG? Patty says it is now a non-profit
corporation in New Jersey.<br>
<br>
"JA-SIG, Inc." is the official name.<br>
<br>
<br>
<br>
<br>
<br>
<h3>uPortal Documentation </h3>
facilitated by John Fereira<br>
<br>
Most of the documentation is now being created on the Wiki
(<a href="http://jasigch.princeton.edu:9000/homepage.action">Confluence</a>),
so do we keep putting things on the main website or
mostly on the Wiki?<br>
<br>
Recently there has been less opportunity for people to write the formal
documentation. Easier to write briefer pieces -- how to solve a
specific problem.<br>
<br>
John thought that the things on the Wiki would be early drafts of
things that would later be turned into formal docs. But that process is
not yet happening.<br>
<br>
Some months ago John demonstrated running a tool called <a
 href="http://jakarta.apache.org/velocity/anakia.html">Anakia</a> on
the
CVS material to produce more nicely formatted and organized docs. He
suggests that this sort of thing should be done.<br>
<br>
At present, the entire www.uportal.org IS NOTHING BUT a live view on
the docs subdirectory of the CVS project. <br>
<br>
Doug G.: (a) CVS has a way to run a script on check-in that could e.g.
generate Anakia documentation if needed. (b) Wouldn't it be better to
have a way to 'digest' the Confluence material, which is inherently in
a state of flux, to make more static documentation for releases?<br>
<br>
John: has a module in CVS called uportal_documentation that contains a
snapshot of all the documentation in xml format. The Anakia ant task
transforms the xml documentation into html pages, creating "web" and
"print" versions.<br>
<br>
<br>
<br>
<br>
<h3>uPortal-Sakai integration</h3>
Andrew Petro did most of this presentation, with Charles Severance
present [he arrived during lunchtime]<br>
<br>
[This presentation is in part from the <a
 href="http://jasigch.princeton.edu:9000/download/attachments/4709/2005_03_sakai_portal_vawp9-2.ppt?version=1">Powerpoint
presentation</a> which has much more detail.]<br>
<br>
<a href="http://www.sakaiproject.org/">Sakai</a> had navigation
requirements. Originally David Haines at Sakai
modified up2.4 to make possible what Sakai wanted, but this proved too
drastic.<br>
<br>
The new plan is to introduce IFrames and WSRP to Sakai, and look at
Sakai through uPortal that way. That's phase I. The second phase will
be to make Sakai tools available as JSR-168 portlets that can run in
uPortal.<br>
<br>
Sakai is a Learning Management System, not a portal as such. A portal
should be customizable, many things available at the same time. An LMS
is not usually highly customizable by its end users, and users want to
work with only one thing at a time.<br>
<br>
integration goals:<br>
<br>
-- Sakai TPP Tools will run as JSR-168 portlets.<br>
-- An entire Sakai site can be included at some point in an enterprise
portal<br>
&nbsp;&nbsp;&nbsp; IFrames - separate sign on<br>
&nbsp;&nbsp;&nbsp; WSRP -- shared sign on.<br>
-- Sakai sites, tools, or pages, can be aggregated to produce a
personal federated view for an individual -- moves toward a personal
learning and research environment.<br>
<br>
these are NOT goals:<br>
-- uPortal administration replaces Sakai administration. No, Sakai has
its own.<br>
-- uPortal navigation supports Sakai's every Learning and Collaboration
environment need. No.<br>
<br>
Integration directions<br>
<br>
Summer 2004 -- decided that Sakai will be at first portal-agnostic<br>
<br>
Outline<br>
&nbsp;&nbsp;&nbsp; 1.0 -- integral aggregator with IFrames 10/04<br>
&nbsp;&nbsp;&nbsp; 1.5 -- IFrames 02/05 just came out<br>
&nbsp;&nbsp;&nbsp; 2.0 -- minimal WSRP (05/05)<br>
&nbsp;&nbsp;&nbsp; Post 2.0 -- Sakai tools available as JSR-168
portlets that run in uPortal<br>
<br>
<br>
Phase I<br>
<br>
Sakai and uPortal deployed separately<br>
based on IFrames in uPortal pointing at Sakai or WSRP pointing at Sakai<br>
This integration will work between Sakai and any portal product which
supports IFrames<br>
Management and andministration will be done separately for the two.<br>
<br>
<br>
Phase II<br>
<br>
-- Get uPortal and Sakai in the same JVM with uPortal handling
navigation and layout for Sakai portlets.<br>
-- Sakai portlets will be JSR-168 adapted.<br>
-- In phase II Sakai will continue to interoperate with other portals
using WSRP and IFrames, with uPortal being WSRP producer.<br>
-- There are many technical challenges.<br>
<br>
Charles did part of the presentation:<br>
Sakai integration phase I through Sakai 2.0<br>
-- parts can appear as IFrames within uportal<br>
-- adding a WSRP producer to Sakai so portals can show things thereby.<br>
[Charles showed what this looks like]<br>
Charles wants to use a portal to federate among many different
instances of Sakai.<br>
<br>
Phase 1 tasks:<br>
WSRP Consumer in uportal<br>
IFrame producer in Sakai (1.5)<br>
WSRP producer in Sakai (2.0)<br>
Working on this: Beth Kirshner (UM), Vishal Prashant (SunGard)<br>
May start effort to build a better WSRP consumer for uPortal if Sakai's
producer becomes "better".<br>
<br>
Vishal Goenka: I've been comparing WSRP and JSR-168 APIs
to see what commonality there is. Whether it is easier to go through
the JSR-168 adapter to do a particular function or to write it natively.<br>
<br>
Phase II<br>
<br>
Sakai tools will appear in uPortal as JSR-168 channels<br>
Administered by uPortal admin tools; that is, with respect to
publishing, subscribing, positioning in layout.<br>
Run inside same JVM<br>
uPortal will render all navigation (as now)<br>
<br>
Sakai tools use <a href="http://jakarta.apache.org/velocity/">Velocity</a>
and JSF [<a href="http://java.sun.com/j2ee/javaserverfaces/index.jsp">Java
Server
Faces</a>] view technologies.<br>
<br>
Sakai's internals are being rearchitected to have less in its "kernel"
-- the environment-specific part. This will be the only part that will
have to be modified to work with other view technologies such as
JSR-168.<br>
<br>
JSR-168 portlets other than Sakai Tools may wish to use the Sakai
Applications Framework (SAF) Kernel.<br>
<br>
The Phase II work will be led by Yale. This is going to be Andrew
Petro's primary responsibility for a while.<br>
<br>
Make JSR-168 and JSF work in uportal<br>
Make SAF kernel work in uportal<br>
Make JSR-168 Velocity gateway work<br>
Build plugins for Sakai Common Services which talk to uPortal users and
groups<br>
<br>
Broader opportunities:<br>
Solve the ability to deliver asynchronous events to the browser.
[Sakai's 'courier']<br>
<br>
Dan: give an example of uPortal 'managing' a Sakai service, as you said
in one of your slides?<br>
<br>
Andrew: the portlets will be Sakai because they use Sakai resources out
the back end. But uPortal will manage the portlet parts of their nature.<br>
<br>
It was never to be intended to be delivered before December 2005
anyway. Charles thought that development was going to be starting in
June, but Yale and Andrew offered to do some work starting in April.
The phase II effort will not be as aggressive a schedule as phase I has
been.<br>
<br>
Charles: I have a 20-slide presentation that I will send around instead
of presenting here. We have figured out a way to write Sakai services
in a flexible, Spring-like way. the way we do this may be helpful to
the uPortal 3.0 effort.<br>
<br>
<br>
<br>
<br>
<br>
<h3>uPortal 2.6:</h3>
by Andrew Petro<br>
<br>
[These notes are taken in part from the <a
 href="http://jasigch.princeton.edu:9000/download/attachments/4732/uP26.ppt?version=1">Powerpoint
presentation</a> which has more detail.]<br>
<br>
We usually put out dot releases every six months or so.<br>
<br>
The Jira tool allows us to track issues which could be proposed new
features for a release, allowing us to contruct a "Roadmap".<br>
<br>
Andrew showed (statically) what Jira can keep track of, including its
integration with CVS, so you can see e.g what commits mentioned this
issue I.D.<br>
<br>
he suggests things to consider for 2.6:<br>
-- stability<br>
&nbsp;&nbsp;&nbsp; plugging memory leaks<br>
&nbsp;&nbsp;&nbsp; fixing bugs<br>
&nbsp;&nbsp;&nbsp; making our portal robust<br>
-- skinning<br>
&nbsp;&nbsp;&nbsp; Jason Shao's ideas and efforts<br>
&nbsp;&nbsp;&nbsp; more use of CSS's and nested divs instead of
explicit markup.<br>
-- more layout work<br>
&nbsp;&nbsp;&nbsp; DLM<br>
&nbsp;&nbsp;&nbsp; DLM / ALM marriage<br>
&nbsp;&nbsp;&nbsp; programmatic creation of fragments<br>
-- nested tabs<br>
&nbsp;&nbsp;&nbsp; make more screen real estate<br>
-- WSRP consumption<br>
&nbsp;&nbsp;&nbsp; improve it<br>
-- Sakai integration work<br>
&nbsp;&nbsp;&nbsp; improving uPortal by taking advantage of resources
made available by Sakai.<br>
<br>
There are some suggested new features left over from Bugzilla (the bug
tracking software that uPortal used before Jira), some
good ideas that we haven't yet implemented and they would be worth
reviewing.<br>
<br>
An example of a leftover from Bugzilla is persisting minimizedness of
channels as part of layout preferences.<br>
[Peter K. suggested a very simple way to do this]<br>
<br>
undoubtedly some 2.5 planned stuff did not get done.<br>
<br>
Documentation<br>
Administrator tools [duplicating ant tasks]<br>
<br>
Groups and Permissions<br>
<br>
-- extract into standalone API and/or a jar<br>
<br>
-- Keith Stacks' permissions ideas/work.<br>
<br>
What enhancements made locally? What enhancements do we need?<br>
<br>
Nick: Some management types have asked for session replication.<br>
<br>
Duffy: I am trying to work on 'programmatically creatable fragments'
and 'internal navigation'. Is that something we want for 2.6 or wait
until 3.0?<br>
<br>
Peter K: It will be a lot easier for someone to do that in 3.0.<br>
<br>
[Since the meeting, a path forward has been agreed upon: discover uP
2.6 goals via list discussion, and in our Confluence Wiki, then make
these into a roadmap of scheduled issues in Jira.]<br>
<br>
<br>
<br>
<br>
<br>
<br>
<h3>Permissions Framework</h3>
-- Keith Stacks<br>
<br>
SunGard SCT refers to the principal associated with a channel as the
"audience" (who can get
at that channel). Their permissions model has a much more flexible way
of granting permissions, using complex boolean logic expressions.
SunGard
SCT is contributing this model to the JA-SIG code base.<br>
<br>
They
have an easy way to edit these complex expressions with a series of
selections from drop down lists rather than having to type expressions
by hand. He showed in slides how it works. It will be available both
from the Channel Manager when setting channel permissions, and from the
Permissions Manager.<br>
<br>
The user attributes from the PAGS can be used directly; other groups
are from the regular groups service.<br>
<br>
There are several new classes, including IEntityFilterGroup (which
holds the new style of permission expressions)<br>
and IOperator (which represents the individual AND/OR/NOT operators,
and which can be expanded with new operators).<br>
<br>
Further modifications needed to the existing infrastructure consist of:<br>
<br>
Need to add a column to the UP_PERMISSION table<br>
IPermission updates<br>
IPermissibles API to indicate whether an activity supports a restriction<br>
A new User Attributes servant <br>
Runtime updatable PAGS store<br>
PAGS store will support named and unnamed groups [unnamed are the
AND/OR things]<br>
<br>
Dan: Keith spoke of fine-grained permissions -- refers to the GUI and
it could be done a variety of ways. Fine-grained restrictions is the
part that changes the underlying design. Dan has a concern that this
design requires adding PAGS in order to work. Keith says that the "User
Attributes" part of their permissions is a pluggable configuration,
which is currently by default configured to use PAGS.<br>
<br>
Charles asked whether this was usable from JSR-168, which cannot get
directly at Java Interfaces.<br>
<br>
<br>
<br>
<br>
<br>
<br>
<span style="font-weight: bold;">NOTE</span>: On Monday evening we met
for dinner at a nearby restaurant in
honor of Ken Weiner who served as project lead of uPortal for several
years, but who recently left for another position. Ken joined us for
the dinner.<br>
<br>
<br>
<br>
<br>
<br>
<br>
<h3>TUESDAY March 22</h3>
<br>
<br>
<br>
<br>
Eric Dalquist<br>
-- we want to put the presentations online<br>
<br>
<br>
<br>
<br>
<h3>uPortal 3</h3>
facilitated by Peter Kharchenko<br>
<br>
[These notes are taken in part from the <a
 href="http://jasigch.princeton.edu:9000/download/attachments/2596/uPortal3Intro.ppt?version=1">Powerpoint
presentation</a>, which has more detail.]<br>
<br>
Strategic goals:<br>
-- configuration flexibility<br>
&nbsp;&nbsp;&nbsp; rendering mechanisms<br>
&nbsp;&nbsp;&nbsp; HTTP parameter generating/processing mechanisms<br>
&nbsp;&nbsp;&nbsp; data layer implementations<br>
-- long-term maintenance<br>
&nbsp;&nbsp;&nbsp; isolated, individually configured groups of
components<br>
&nbsp;&nbsp;&nbsp; transparent, sparse coupling<br>
<br>
Tactical goals<br>
-- JSR-168 support -- in uportal 2 it's more obviously an afterthought;
make it more integral<br>
-- Sakai integration <br>
-- uPortal2 support<br>
-- Complete WSRP integration<br>
<br>
<br>
Sakai beta -- June 2005<br>
&nbsp;&nbsp;&nbsp; implements minimum Sakai phase II requirements<br>
<br>
3.0 Beta: non-2.x users -- August 2005<br>
&nbsp;&nbsp;&nbsp; completes Sakai integration requirements<br>
&nbsp;&nbsp;&nbsp; completes core features for new uportal adopters<br>
<br>
3.0 Final: Upgrades -- September/October 2005<br>
&nbsp;&nbsp;&nbsp; migration tools for existing 2.x users<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IChannel adapter, DB
migration<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Requirements not finalized at
this time<br>
<br>
<br>
up3 dependencies<br>
<br>
uPortal<br>
&nbsp;&nbsp;&nbsp; make sure that available 3.0 resources are actually
being applied to 3.0 [resources as in people's time; this means don't
get sidetracked on other things]<br>
&nbsp;&nbsp;&nbsp; Support from 2.x resources<br>
&nbsp;&nbsp;&nbsp; Define upgrade/migration tools<br>
<br>
Sakai<br>
&nbsp;&nbsp;&nbsp; Refining Sakai requirements past June release<br>
&nbsp;&nbsp;&nbsp; Development<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WSRP consumer, deployment testing<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; alternative (to up2)
skin/structure<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; OSID Authentication/Authorization<br>
<br>
Testing<br>
&nbsp;&nbsp;&nbsp; identify resources/institutions<br>
&nbsp;&nbsp;&nbsp; QA and Performance Test<br>
<br>
<br>
<br>
<br>
<br>
<h3>Quality Assurance and Testing</h3>
facilitated by Eric Dalquist<br>
<br>
&nbsp;&nbsp;&nbsp; Standardization on what testing processes are done
before a release is cut<br>
&nbsp;&nbsp;&nbsp; There should be scripts etc. to do the cutting of a
release<br>
&nbsp;&nbsp;&nbsp; There needs to be documentation on how to test. e.g.
Simple Layouts were not being tested.<br>
&nbsp;&nbsp;&nbsp; <br>
<br>
Curt: Is it considered too difficult to set up regression tests [a test
suite]?<br>
<br>
Eric: That would be great. Would someone be interested in writing more
unit tests for up 2.x? There are not many as yet.<br>
<br>
Andrew: in 2.5 there is an approach to creating a fake data source,
that can be used for unit testing. Perhaps an evolving test structure
will be happening in 2.x, rather than 'test everything ASAP', such that
as people touch various parts of code, they can add JUnit tests.<br>
<br>
Scott: Faizan has user acceptance tests. We're setting up <a
 href="http://cruisecontrol.sourceforge.net/">CruiseControl</a>
(automated build tool) to run on Confluence on the Clearinghouse
machine. Maybe we should run
it on uPortal also. And we have a license for <a
 href="http://www.cenqua.com/clover/">Clover</a> (unit testing
evaluator).<br>
<br>
Eric: The people who do the next few releases should be writing up what
they do, which will be the beginning of the documentation.<br>
<br>
Dan: Some people at various institutions would test things relevant to
their individual site. We should gather all these tests.<br>
<br>
Duffy: Mentioned '<a href="http://httpunit.sourceforge.net/">HttpUnit</a>'
which can do live scripted testing.<br>
<br>
Eric: Whoever is in charge of making the release, has the
responsibility of finding others to test it.<br>
<br>
Scott: We need a documented process of testing, in case the person
responsible has an emergency of some kind.<br>
<br>
Peter K: We are being very careful in writing unit tests for 3.0. But
we don't have a functional test. What experience do people have with
automated functional testing?<br>
<br>
Peter K: For some things it is more realistic to automate testing, than
for other things. For example publishing a portlet, subscribing to it,
seeing if it actually renders.<br>
<br>
Nick: You said there would be a nightly build process; how about a
nightly deploy process? Maybe we could deploy it on the clearinghouse
machine and people could try it out.<br>
<br>
Nick: Regression testing tools are very expensive and none of them
beats the human eye.<br>
<br>
Peter K: I think Cruise Control will help a good bit.<br>
<br>
Scott: I agree we need a deployed instance available somewhere.<br>
<br>
Mark: (a) Documentation of unit testing (b) Add a unit test to test
anything newly coded (c) A place to run these tests (d) a deployed
instance.<br>
<br>
Cris: Then you can talk about automated performance testing. Which
would find memory leaks right when they are added.<br>
<br>
There was a discussion of whether we can expect a 'dot zero' release to
have no known unresolved bugs. Some thought that either this should be
required, or we should only call it a "release candidate". Others
thought that even commercial software does not achieve this; therefore
we should inform the user community to proceed with caution.<br>
<br>
Another issue discussed was, can we identify more people's time to
apply to do additional pre-release testing? Charles Severance said
regarding that: Sakai has a volunteer QA effort. The people who are
responsible for making Sakai work at various sites, some are willing to
try out the new code to see if it is good. We have gotten volunteer QA
to work. We tell them to use Jira to report problems, then the
developers monitor that. There needs to be leadership for QA, but it
probably should not be a developer.<br>
<br>
<br>
<br>
<br>
<h3>Rendering Contexts and components for uportal 3</h3>
by Peter Kharchenko<br>
<br>
[These notes are taken in part from the <a
 href="http://jasigch.princeton.edu:9000/download/attachments/2596/uPortal3Contexts.ppt?version=1">Powerpoint
presentation</a> which has more detail.]<br>
&nbsp;<br>
[The concept is, that the entire way that uPortal determines a user's
layout, prepares it for display, and responds to inputs, can be
different for different
users in the same instance of uPortal. Actually, a user might even
switch between contexts within the scope of the same session.]<br>
<br>
What is a uportal 3 context?<br>
&nbsp;&nbsp;&nbsp; defines all aspects of a traditional uportal instance<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; design, navigation, profiles<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; parameter syntax<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; portlet selections, session scopes<br>
&nbsp;&nbsp;&nbsp; multiple concurrent contexts can be used<br>
<br>
example contexts<br>
&nbsp;&nbsp;&nbsp; static frame showing a single portlet<br>
&nbsp;&nbsp;&nbsp; simple navigation with human-readable URLs<br>
&nbsp;&nbsp;&nbsp; uportal 2 clone<br>
<br>
<br>
[a graphic] showing a context resolver at the top that routes requests
to appropriate context, and one of the contexts under it is the
imitation of uportal2.<br>
<br>
<h4>context resolvers:</h4>
Servlet Path context resolver<br>
&nbsp;&nbsp;&nbsp; switch contexts by going to a specific servlet path<br>
&nbsp;&nbsp;&nbsp; default, ServletPathContextResolver implementation<br>
<br>
Atlernatively contexts can be resolved using<br>
&nbsp;&nbsp;&nbsp; user information&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; authentication state<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; user affiliation (groups),
attributes (permissions)<br>
&nbsp;&nbsp;&nbsp; user agent information (browser)<br>
&nbsp;&nbsp;&nbsp; internal states, session (e.g. down for maintenance)<br>
<br>
Mark: could you make a context that does not create a session? e.g. for
Guest user.<br>
Peter K: Yes.<br>
<br>
<br>
Context responsibilities:<br>
&nbsp;&nbsp;&nbsp; User interaction<br>
&nbsp;&nbsp;&nbsp; Presentation<br>
<br>
<br>
IContext<br>
&nbsp;&nbsp;&nbsp; service (HTTPRequest, HttpResponse)<br>
<br>
CompoundContext implements IContext<br>
&nbsp;&nbsp;&nbsp; separates parameter processing and rendering<br>
&nbsp;&nbsp;&nbsp; IRequestParameterController<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
processparameters(HttpRequest,HttpResponse)<br>
&nbsp;&nbsp;&nbsp; IPortalRenderer<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; render(HttpRequest, HttpResponse)<br>
<br>
Rendering: drilling down<br>
<br>
TreeRenderer implements IPortalRenderer<br>
&nbsp;&nbsp;&nbsp; Assumes a rooted structure of components<br>
&nbsp;&nbsp;&nbsp; Responsible for rendering cycle initiation/events<br>
&nbsp;&nbsp;&nbsp; <br>
IRenderingComponentManager<br>
&nbsp;&nbsp;&nbsp; Defines the topology of rendering components<br>
&nbsp;&nbsp;&nbsp; Responsible for finding optimal cache entry points<br>
<br>
PipelineComponentManager<br>
&nbsp;&nbsp;&nbsp; defines linear pipeline rendering structures<br>
<br>
<h4>Rendering: SAX pipelines</h4>
uportal2-like pipeline in which components pass SAX events to each other<br>
<br>
ISaxConsumer and ISaxRenderer<br>
<br>
components<br>
&nbsp;&nbsp;&nbsp; abstract filters and buffers<br>
&nbsp;&nbsp;&nbsp; Serializers<br>
&nbsp;&nbsp;&nbsp; XSL transformers<br>
<br>
SAX Cache entry points<br>
&nbsp;&nbsp;&nbsp; know how to replay cache<br>
&nbsp;&nbsp;&nbsp; returned by cache managers<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; implementing IPipelineCacheManager<br>
<br>
<h4>Rendering: String pipelines</h4>
Pipeline that operates by transforming Strings<br>
quick, non-restricted<br>
<br>
IStringRenderer and IStringFilter<br>
Components<br>
&nbsp;&nbsp;&nbsp; RegexStringFilter<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PortletRenderingInitiationFilter<br>
&nbsp;&nbsp;&nbsp; StringResponseWriter<br>
String cache filters, managers, entry points<br>
<br>
<h4>Rendering: Hybrid pipelines</h4>
Pipelines that can be configured with multiple types of components<br>
&nbsp;&nbsp;&nbsp; org.jasig.portal.rendering.hybrid<br>
&nbsp;&nbsp;&nbsp; component manager implementation<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; connector structure<br>
&nbsp;&nbsp;&nbsp; cache manager implementation<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; multiple cache types<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; prioritized<br>
<br>
Sould be primary choice for configuring context rendering<br>
<br>
up2 context example<br>
<br>
<br>
[He showed an XML example of a uPortal components configuration]<br>
<br>
<h4>Rendering: XML Layout sources</h4>
Starting point for the Sax pipelines<br>
&nbsp;&nbsp;&nbsp; XmlFileLayoutSource<br>
<br>
org.jasig.portal.layout.uportal2 package<br>
&nbsp;&nbsp;&nbsp; LegacyLayoutSource<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; wraps IUserLayoutManager<br>
&nbsp;&nbsp;&nbsp; SimpleUserLayoutManager<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; lightly modified uportal2 version<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; with simplified DAO Impl<br>
<br>
<h4>Rendering: XSLT TransformationFilter</h4>
A flexible XSLT SAX Rendering component<br>
&nbsp;&nbsp;&nbsp; configured with ITransformerPreferences<br>
&nbsp;&nbsp;&nbsp; insert arbitrary element attributes and params<br>
Transformer preferences<br>
&nbsp;&nbsp;&nbsp; contain IStylesheetDescriptoin<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; location, mime type, etc.<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; IParamDescription and
IElementAttributeDescription<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; default
values, persistence scope, target elements<br>
&nbsp;&nbsp;&nbsp; responsible for keeping track of current values of
stylesheet params, attributes<br>
&nbsp;&nbsp;&nbsp; RuntimeTransformerPreferences (in memory)<br>
&nbsp;&nbsp;&nbsp; TransformerPreferencesImpl (persistent)<br>
ITransformerHelper - stylesheet handling<br>
<br>
[He showed an XML example of attributes configuration]<br>
<br>
now he went back to an earlier slide to talk about the<br>
<h4>IRequestParameterController</h4>
CompoundContext parameter processing<br>
<br>
Before the rendering starts, need to make sense of the request
parameters<br>
<br>
RequestParameterProcessorListController<br>
&nbsp;&nbsp;&nbsp; based on a prioritized list of parameter processors<br>
&nbsp;&nbsp;&nbsp; each parameter processor talks to some component<br>
&nbsp;&nbsp;&nbsp; ordered list of IRequestParameterProcessors<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; boolean processParameters(req,
res)<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; allows multiple rounds of
processing for variable evaluation<br>
&nbsp;&nbsp;&nbsp; set of IUrlConstructorProviders<br>
<br>
Example: uportal2 transformation legacy syntax<br>
<br>
<br>
Context patterns: parameter-aware component<br>
<br>
Goal<br>
&nbsp;&nbsp;&nbsp; isolation and targeted injection of components<br>
Parameter-aware context component<br>
&nbsp;&nbsp;&nbsp; directly involved in the rendering<br>
&nbsp;&nbsp;&nbsp; assisting other rendering components<br>
&nbsp;&nbsp;&nbsp; assisting other parameter processors<br>
Pattern:<br>
&nbsp;&nbsp;&nbsp; implement URL constructor (ie. how to write)<br>
&nbsp;&nbsp;&nbsp; implement ParameterProcessor (i.e. how to parse)<br>
&nbsp;&nbsp;&nbsp; Connect processor, component itself and other pieces
using dependency injection<br>
&nbsp;&nbsp;&nbsp; Test URL constructor and processor against each other<br>
<br>
<br>
Example 1: Legacy up2 Layout param syntax<br>
<br>
Example 2: persistence manager<br>
&nbsp;&nbsp;&nbsp; job: fire off persistence events<br>
&nbsp;&nbsp;&nbsp; request param command to initiate persistence<br>
&nbsp;&nbsp;&nbsp; no rendering, just param processing<br>
...<br>
<br>
<br>
The fate of the URL constructors<br>
<br>
Controller configuration is passed to Pluto's PortletURLFactoryImpl<br>
<br>
PortletURL delivered to the portlets<br>
&nbsp;&nbsp;&nbsp; implements IPortletURL<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; adds ability to obtain
uPortal-specific URL constructors<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; getUrlConstructor (name)<br>
&nbsp;&nbsp;&nbsp; IPortletUrlConstructor<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; implements portlet URL syntax<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; also configurable<br>
<br>
<br>
<span style="font-weight: bold;"><br>
</span>
<h3>Pluto integration, WSRP producer and consumer</h3>
by Michael Ivanov<br>
<br>
<h4>JSR-168 <a href="http://portals.apache.org/pluto/">Pluto</a>
container</h4>
portlet rendering engine<br>
implements JSR-168<br>
provides a runtime environment for portlets and calls Portlet invoker
to execute them<br>
contains interfaces that ...<br>
<br>
[He showed a diagram of the parts of Pluto]<br>
<br>
container methods<br>
<br>
init()/shutdown() lifecycle methods called only once<br>
portletLoad() called only once before aggregation<br>
renderPortlet() -- caled for all portlets once per refresh<br>
processPortletAction() -- called for only one portlet<br>
<br>
<br>
Container Services<br>
<br>
Mandatory Services<br>
&nbsp;&nbsp;&nbsp; Information Provider Service<br>
&nbsp;&nbsp;&nbsp; Factory Manager Service<br>
&nbsp;&nbsp;&nbsp; Log Service<br>
Optional services<br>
&nbsp;&nbsp;&nbsp; Property manager service<br>
&nbsp;&nbsp;&nbsp; Additional portal-specific services<br>
<br>
<br>
Information Provider Service<br>
&nbsp;&nbsp;&nbsp; callback mechanism for the container into the portal<br>
Dynamic and static information provider<br>
<br>
Portal Context Provider<br>
<br>
Provides Pluto with the portal context information<br>
<br>
Pluto's Object Model<br>
Represents portlet information on different levels<br>
['definition' has parameters of a 'class' nature; 'entity' is of an
'object' nature.]<br>
<br>
&nbsp;&nbsp;&nbsp; WebApplicationDefinition<br>
&nbsp;&nbsp;&nbsp; PortletApplicationDefinition<br>
&nbsp;&nbsp;&nbsp; PortletApplicationEntity<br>
&nbsp;&nbsp;&nbsp; ServletDefinition<br>
&nbsp;&nbsp;&nbsp; PortletDefinition<br>
&nbsp;&nbsp;&nbsp; PortletEntity<br>
&nbsp;&nbsp;&nbsp; PortletWindow<br>
<br>
<br>
for uportal3:<br>
implement Pluto's object model interfaces<br>
implement uportal-specific portlet URL<br>
implement dynamic and static information providers<br>
create factories for pluto's components that need to be replaced<br>
implement configurable factory management service<br>
provide factoryManagerService that allows to replace major container
factories within the portal<br>
provide LogService<br>
<br>
in uportal2 we have a 'published' and 'subscribed' channel<br>
'deployments' are the static configuration info. analogous to 'channel
types' -- they have readonly information from the portlet.xml files.<br>
'definitions' -- publish information for a particular portlet. [channel
params]<br>
'entities' -- subscribed portlet [user params]<br>
'windows' -- appearing somewhere in a window [as yet, no distinct prefs
for uportal]<br>
<br>
<br>
Portlet URL implementation<br>
<br>
<br>
PortletURL Constructor<br>
<br>
Constructs Portlet URLs<br>
<br>
Factory Manager Service<br>
<br>
<br>
Vikram: Are you leveraging the sample portal code that comes with Pluto?<br>
Peter K: No, we are specifically trying to avoid using that. We are
writing our side from scratch. uPortal is too different from the Pluto
portal skeleton code. We did use some things from the container
implementation, but we copied it rather than extended it.<br>
<br>
<h4><a
 href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=wsrp">WSRP</a>
Producer in uPortal 3</h4>
[refer to Michael's slides]<br>
<br>
the org.jasig.portal.wsrp.producer.WsrpEngine is the main class<br>
it requires <a href="http://ws.apache.org/axis/">Axis</a><br>
<br>
org.jasig.portal.wsrp.producer.provider.Provider<br>
<br>
an access point for WSRP engine to uportal object model.<br>
<br>
<br>
The WSRP component of the uPortal 3 development is at first using <a
 href="http://java.sun.com/products/jdo/index.jsp">JDO</a> and <a
 href="http://www.jpox.org">JPOX</a> for WSRP Persistence<br>
<br>
Why JDO [he explains this]<br>
<br>
Vikram: <a href="http://ws.apache.org/wsrp4j/">WSRP4J</a> uses a
different db implementation, doesn't it?<br>
Michael: Yes, but we modified it to use JDO.<br>
<br>
Duffy: What about <a href="http://www.hibernate.org/">Hibernate</a>
vs. JDO?<br>
Peter K: JDO is easier because in this case we don't know what we are
going to be persisting. That would be hard to do with <a
 href="http://java.sun.com/blueprints/patterns/DAO.html">DAO</a>,
wouldn't it?<br>
Michael: It would not be hard to change the implementation itself, or
the ones that call it. But we're using JDO to get the WSRP feature
working. Then we will switch over to the standard DAO things in
uportal. By then the latter will be more mature.<br>
<br>
[He gave an example of JDO meta-data]<br>
<br>
<br>
What has been done?<br>
What is in progress?<br>
Open issues<br>
<br>
Do we need <a href="http://www.opensaml.org/">OpenSAML</a> or <a
 href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=wss">WS-Security</a>?
Is it possible to implement them in
WSRP 1.0?<br>
Charles: The real question is, do we need to do more than just trust
the consumer.<br>
Vikram: We can use transport mechanisms to do that -- e.g. SSL.<br>
Charles: First, deal with the problem of trusting our own consumers.
Secondly, deal with the problem of trusting others' consumers.<br>
Adam: We can have transport security, and as several have suggested,
<a href="http://www.yale.edu/tp/auth/cas20.html">CAS Proxy</a> for
authentication. What about signing?<br>
Vikram: Message-level security may not buy us much. [later] WSRP has a
concept of "user category" which is like an authorization "role".<br>
[there was much discussion of WSRP security]<br>
<br>
Is it possible for WSRP Producer to share one Pluto container's
instance with uPortal 3 by changing dynamic providers on-the-fly? i.e.
if regular portal requests and WSRP requests come into the same
instance of the portal servlet can we handle both of them?<br>
There was some discussion of this suggesting how to do it.<br>
<br>
<br>
<br>
<br>
LUNCH BREAK<br>
<br>
<br>
<br>
<h3>uPortal 3 -- Portlet Development</h3>
Eric Dalquist<br>
<br>
One problem is, providing access to portal services from a portlet<br>
&nbsp;&nbsp;&nbsp; [portlets have their own class loader so you can't
get at uPortal classes in the normal way]<br>
&nbsp;&nbsp;&nbsp; Special access-layer classes [shared library
location in the servlet container]<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if the portal API changes, then
the interfaces in this layer have to change as well as their
implementations.<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this increases maintenance
overhead and debugging effort.<br>
&nbsp;&nbsp;&nbsp; Moving services to shared location<br>
<br>
Peter K: the way Sakai does the first one: Constructed cross-context
class loaders with a binding to Spring. From the user application you
are using Spring injection without being aware of the problem.<br>
Adam: Is this servlet-container independent?<br>
Peter K: If the servlet context listener works in a certain way, that
would be the only relevant dependency.<br>
Eric: Casting classes is very difficult between class loaders.<br>
<br>
The other way is to move all the services into a jar in the container
shared library. e.g. the Groups and Permissions.<br>
Adam: Be sure it will work in any J2EE container. Some have had
difficulty with specific containers.<br>
Eric: Well if this would not work, then Pluto would not work anyway
because it depends on the same ability.<br>
Adam: There are already industry-standard ways to do this sort of
thing, maybe this is the time to consider them.<br>
Eric: Pluto works with <a
 href="http://www.bea.com/framework.jsp?CNT=index.htm&amp;FP=/content/products/server">WebLogic</a>,
<a href="http://www.orionserver.com/">Orion</a>, <a
 href="http://jakarta.apache.org/tomcat/">Tomcat</a>. Therefore, this
would
probably also work.<br>
Adam: We should not require one particular servlet container.<br>
Eric: If you put the Groups jar in the shared library, then your
portlet has more dependencies and it does not purely meet the standard.<br>
Cris: Running a portable portlet is not a very exciting thing right
now. There is little you can do with them. The meaty type portlets are
going to require dependencies to the particular portal you want to use.
Is there an effort to enhance JSR-168?<br>
Eric: I haven't seen one. <br>
Vikram: There is some sense that once the WSRP revision is done,
JSR-168 will then be revised.<br>
<br>
Vikram: Where does the Group service fit into a portlet? Is it used via
'IsUserInRole' portlet method, which is static access control, whereas
groups are dynamic?<br>
[there was an extensive discussion of this question]<br>
Some people supposed that we would write only fully standard portlets,
others supposed that we would also write things with portlet APIs but
that also used uportal services ("portlet-like things"). The debate can
be summarized like this: 'But that's not a portlet'. 'Not completely,
but we don't mind.'<br>
<br>
Cris: Here's a tip. If one group (such as JA-SIG) is building a
variety of portlets, you should build your portlets into one web
application, so that you won't get like fifty web applications all
running at once. That's a big performance problem.<br>
<br>
<br>
[NOTE: Bill Thompson was on speakerphone from Rutgers for part of the
afternoon. From sometime in the uPortal3 portlets session, through the
'leadership' session after it]<br>
<br>
<br>
Administrative Portlets<br>
&nbsp;&nbsp;&nbsp; Consistent and flexible UI<br>
&nbsp;&nbsp;&nbsp; Inclusion in the portal web application<br>
<br>
[The rest of this session consisted of Cris H. on his investigation
into what's available for the "consistent and flexible UI" part]<br>
<a
 href="http://opensource.atlassian.com/confluence/spring/spaces/viewspacesummary.action?key=JSR168">Spring
PortletMVC</a><br>
Bill Thompson -- support: it's been in there about a year. The code
seems to be stable enough for production. But maybe it doesn't have the
elegance of the rest of the Spring framework and it has some rough
edges around it. There is some talk to roll it out as a separate Spring
subproject, so that it can be released on its own release cycle. It
just needs some leadership and attention.<br>
<br>
Struts<br>
&nbsp;&nbsp;&nbsp; Beyond what we know and love as Struts today. First
of all, there
is a part of the Struts project being spun off called '<a
 href="http://portals.apache.org/jetspeed-2/multiproject/portals-bridges-struts/index.html">Portals
Bridges</a>'.
it's part of Jetspeed 2 and they are trying to split it off from
Jetspeed.<br>
<br>
Then there are two proposals for Struts 2<br>
one is called <a href="http://wiki.apache.org/struts/StrutsShale">Shale</a>,<br>
and the other is called <a
 href="http://wiki.apache.org/struts/StrutsJericho">Jericho</a>.<br>
The fact that there are two proposals, hints how far away from Struts 2
they are.<br>
Both of them mention portlet support.<br>
<br>
Another thing called <a href="http://www.nabh.com/">MVCPortlet</a>
[not Spring] that is being open sourced
by a company. This is the only one of these that says it's an official
release [and they sell commercial support for it.]<br>
<br>
JSF [<a href="http://java.sun.com/j2ee/javaserverfaces/index.jsp">Java
Server Faces</a>]<br>
&nbsp;&nbsp;&nbsp; Sakai makes heavy use of JSF. JSF kind of takes
development back from web applications to more the way stand alone apps
were written. With for example, events and listeners. Supposedly there
exists shim code to make this work within a portlet.<br>
<br>
<br>
<br>
<h3>uPortal Leadership</h3>
discussion facilitated by Eric Dalquist<br>
<br>
Ken has left. What do we do now?<br>
<br>
-- Long Term Release Management<br>
<br>
-- Development Issue Decision Making<br>
<br>
-- Concrete Leadership Role<br>
<br>
<br>
Development Issue Decision Making<br>
<br>
&nbsp;&nbsp;&nbsp; there was a benevolent dictator kind of position
that he had.<br>
&nbsp;&nbsp;&nbsp; how will we handle such issues now?<br>
<br>
Andrew: Should we have a "Ken version 2" Project Manager?<br>
Doug: Should we split it up into different projects with different
people?<br>
Adam(?): It would be easier to ask someone to volunteer to lead a
project (instead of being specifically paid to do so) if it is smaller
than 'forever'. <br>
<br>
Ken was funded 80 percent development and 20 percent project
management. Does the board want to continue funding someone? Bill
Thompson [on speakerphone] is on the JA-SIG board. The board is looking
to the community for the immediate future. Bill thinks that people who
have the thing in production would pitch in for it. Rutgers would be
willing to help with 2.4.3 and may need some help with working on 2.5.
Andrew (Yale) is very involved with 2.5 so could give advice to Rutgers
about that.<br>
<br>
Jim: Peter K is the chief architect for 3.0.<br>
Peter K: As yet 3.0 is in its infancy so most decisions are still
architectural. As it matures there will be more managerial type
decisions, with which I have much less prior experience. So there
should be more community participation than just me. Or perhaps Eric
could help with that.<br>
<br>
Andrew: Should we say: Please Unicon you're doing the development,
could you also do project management? Or should we say you're doing
enough so someone else should do it?<br>
<br>
Jim: Until December 30, 2005, Carl Jacobsen is responsible for the
Mellon funding and making decisions, so he should make the call on the
3.0 effort. After December 30 the funding ends and it would be
approached differently.<br>
<br>
Doug: from Unicon's perspective, within the company, Eric would be the
best choice to do 3.0 project management.<br>
<br>
Bill T: I'm not sure we need a meta manager for 2.x&nbsp; as long as
there are volunteers for each dot release. <br>
<br>
Eric: One thing that isn't covered is when Ken used to make sure that a
patch on the HEAD also goes into the patches branch or vice versa.<br>
<br>
<br>
<br>
Bill T: Regarding the memory leak issues you discussed. Our intent with
Scott was to share what our struggles have been so we can head off
things before they bite us in production. We released with expectations
of quality [that were not met]. I think we need to adopt the concept of
quality and have a QA process. So that people will know what to expect.<br>
<br>
<br>
<br>
BREAK<br>
<br>
<br>
<br>
<h3>Miscellaneous uPortal 3 Questions</h3>
<br>
by Peter Kharchenko<br>
[he just brought up these things that need to be decided eventually;
there was no attempt to discuss them at length or make decisions]<br>
<br>
[These notes are based in part on the <a
 href="http://jasigch.princeton.edu:9000/download/attachments/2596/uPortal3misc.ppt?version=1">Powerpoint
presentation</a>, which has more detail.]<br>
<br>
<h5>layout managers</h5>
Choices:<br>
&nbsp;&nbsp;&nbsp; simple user layout manager<br>
&nbsp;&nbsp;&nbsp; ALM<br>
&nbsp;&nbsp;&nbsp; DLM<br>
&nbsp;&nbsp;&nbsp; Integration? [we want to eventually have one code
base for those two things, merge the features; but the effort has been
pushed off into the future because there are not resources for it at
present]<br>
<br>
Sakai Priorities<br>
&nbsp;&nbsp;&nbsp; simple layout manager is sufficient for Phase II<br>
<br>
Community evaluation of choices/requirements<br>
<br>
<h5>uportal3 authentication</h5>
uportal2 interfaces<br>
&nbsp;&nbsp;&nbsp; multiple authentication context<br>
&nbsp;&nbsp;&nbsp; opaque credentials<br>
<br>
why not use some existing framework to do some of it for us?<br>
<br>
Acegi [AY-see-gee]<br>
&nbsp;&nbsp;&nbsp; default db, ldap<br>
&nbsp;&nbsp;&nbsp; CAS<br>
<br>
What information do we need from authentication subsystem?<br>
<br>
<h5>uportal3: navigation, back button</h5>
uportal2 structure/theme<br>
Alternative skin (theme) -- SAKAI<br>
Alternative structure<br>
&nbsp;&nbsp;&nbsp; trees<br>
&nbsp;&nbsp;&nbsp; nested tabs<br>
&nbsp;&nbsp;&nbsp; tabs/trees combo (U. Wisconsin)<br>
<br>
Back button behavior<br>
&nbsp;&nbsp;&nbsp; -- GET<br>
&nbsp;&nbsp;&nbsp; -- POST<br>
<br>
To make the back button work properly we would have to have idempotent
[can only have an effect once] URLs.<br>
<br>
Eric: The biggest problem is to be able to have two windows open on the
same portal and interact with both of them at once. Because the
location in the portal is part of your session, not part of the link. <br>
Andrew: Also, bookmarkable links would be great. (going directly to a
specific tab or focused portlet). <br>
<br>
<h5>service integration</h5>
Main services from uPortal2<br>
&nbsp;&nbsp;&nbsp; directory<br>
&nbsp;&nbsp;&nbsp; groups<br>
&nbsp;&nbsp;&nbsp; permissions<br>
<br>
how to share?<br>
&nbsp;&nbsp;&nbsp; avoid maintaining two copies [for up2 and up3]<br>
&nbsp;&nbsp;&nbsp; separate deployment of each service<br>
<br>
[i.e. pull these pieces out of the code base so they can be the same
for up2 and up3]<br>
<br>
<br>
<br>
<h5>community involvement requested for the development of uPortal 3:</h5>
Internationalization (XLIFF, etc.)<br>
<br>
Administrative Portlets<br>
&nbsp;&nbsp;&nbsp; publish, subscribe (extensions)<br>
&nbsp;&nbsp;&nbsp; compound preferences portlet<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; profiles, skins,
internationalization<br>
&nbsp;&nbsp;&nbsp; runtime administration<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cache control [empty them or tune
performance characteristics] [2.5 we can dump some caches from the
Channel Admin channel]<br>
<br>
IChannel adapter to allow old channels to run in uPortal 3<br>
Upgrade tools<br>
<br>
<br>
<br>
<br>
<span style="font-weight: bold;">NOTE:</span> A few minutes before the
very end of our meeting, we were
reminded that we were meeting in California, by way of a magnitude 3.4
(i.e minor) earthquake, whose epicenter was 4 miles to the southwest
beneath Santa Monica Bay. It lasted about 3 seconds.<br>
<br>
<br>
END OF DOCUMENT<br>
</body>
</html>
