<?xml version="1.0"?>
<!--

    Copyright (c) 2000-2009, Jasig, Inc.
    See license distributed with this file and available online at
    https://www.ja-sig.org/svn/jasig-parent/tags/rel-10/license-header.txt

-->
<!-- $Header$ -->


<managedLayoutFragments xmlns:dlm="http://org.jasig.portal.layout.dlm.config">

  <dlm:property name='defaultLayoutOwner' value='fragmentTemplate'/>
  <!--  <dlm:property name='layoutDecorator' value='someClass'/> -->
  
  <!-- Controls clearing of dlm fragment cache.  This allows changes  made to layout
  owners to be reflected once the cache has been updated.  Specified in minutes. -->
  
  <dlm:property name='org.jasig.portal.layout.dlm.RDBMDistributedLayoutStore.fragment_cache_refresh' value="5"/>

  <!--
   | Uncomment this property to turn on the 'RDBMConfigurationLoader' implementation, 
   | which stores FragmentDefinition instances in the database via JPA and Hibernate.  
   | The advantage of this approach is that fragment definitions can be 
   | added/removed/modified without a portal restart.  Without this property, DLM 
   | will behave exactly as it always has.
   |
   | If you decide to enable this functionality, you should also:
   |   - Uncomment the "fragmentDefinitionDao" bean in persistenceContext.xml
   |   - Uncomment the "org.jasig.portal.layout.dlm.Evaluator" cache in ehcache.xml
   +-->
  <!--
  <dlm:property name="ConfigurationLoader.impl" value="org.jasig.portal.layout.dlm.RDBMConfigurationLoader"/>
  -->
  
  <dlm:fragment name='Guests' ownerID='guest-lo' precedence='80'>
    <dlm:audience evaluatorFactory='org.jasig.portal.layout.dlm.providers.GuestUserEvaluatorFactory'/>
  </dlm:fragment>
  
  <dlm:fragment name='Welcome' ownerID='welcome-lo' precedence='80'>
    <dlm:audience evaluatorFactory='org.jasig.portal.layout.dlm.providers.PersonEvaluatorFactory'>
      <paren mode="NOT">
        <attribute name="username" mode='equals' value='guest'/>
      </paren>
    </dlm:audience>
  </dlm:fragment>

  <dlm:fragment name='News' ownerID='news-lo' precedence='60'>
    <dlm:audience evaluatorFactory='org.jasig.portal.layout.dlm.providers.AllUsersEvaluatorFactory'/>
  </dlm:fragment>
  
  <dlm:fragment name='Faculty' ownerID='faculty-lo' precedence='50'>
    <dlm:audience evaluatorFactory='org.jasig.portal.layout.dlm.providers.GroupMembershipEvaluatorFactory'>
      <paren mode="OR">     
        <attribute mode='memberOf' name='Faculty'/>
      </paren>
    </dlm:audience>
  </dlm:fragment>
  
  <dlm:fragment name='Staff' ownerID='staff-lo' precedence='50'>
    <dlm:audience evaluatorFactory='org.jasig.portal.layout.dlm.providers.GroupMembershipEvaluatorFactory'>
      <paren mode="OR">     
        <attribute mode='memberOf' name='Staff'/>
      </paren>
    </dlm:audience>
  </dlm:fragment>
  
  <dlm:fragment name='Student' ownerID='student-lo' precedence='50'>
    <dlm:audience evaluatorFactory='org.jasig.portal.layout.dlm.providers.GroupMembershipEvaluatorFactory'>
      <paren mode="OR">     
        <attribute mode='memberOf' name='Students'/>
      </paren>
    </dlm:audience>
  </dlm:fragment>
  
  <dlm:fragment name='Developer' ownerID='developer-lo' precedence='40'>
    <dlm:audience evaluatorFactory='org.jasig.portal.layout.dlm.providers.GroupMembershipEvaluatorFactory'>
      <paren mode="OR">     
        <attribute mode='memberOf' name='Portal Developers'/>
      </paren>
    </dlm:audience>
  </dlm:fragment>
  
  <dlm:fragment name='Admin' ownerID='admin-lo' precedence='40'>
    <dlm:audience evaluatorFactory='org.jasig.portal.layout.dlm.providers.GroupMembershipEvaluatorFactory'>
      <paren mode="OR">     
        <attribute mode='memberOf' name='Portal Administrators'/>
        <attribute mode='memberOf' name='Portal Developers'/>
      </paren>
    </dlm:audience>
  </dlm:fragment>

</managedLayoutFragments>

